
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Correcting the melanopic action spectrum for age &#8212; PySilSub 0.0.14 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 150;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Correcting-the-melanopic-action-spectrum-for-age">
<h1>Correcting the melanopic action spectrum for age<a class="headerlink" href="#Correcting-the-melanopic-action-spectrum-for-age" title="Permalink to this heading">¶</a></h1>
<section id="A.4-The-melanopic-action-spectrum-(from-CIE-S-026/E:2018)">
<h2>A.4 The melanopic action spectrum (from CIE S 026/E:2018)<a class="headerlink" href="#A.4-The-melanopic-action-spectrum-(from-CIE-S-026/E:2018)" title="Permalink to this heading">¶</a></h2>
<p>The following steps have been adopted to derive the melanopic action spectrum as employed in this standard (see also Lucas et al. (2014), and CIE (2015):</p>
<ol class="arabic simple">
<li><p>The action spectrum of the human melanopsin protein can be described by an (opsin:vitamin A)-based photopigment template (<a class="reference external" href="https://www.cambridge.org/core/journals/visual-neuroscience/article/abs/in-search-of-the-visual-pigment-template/A4738E821720092B7F5A233C4AB4962B">Govardovskii et al., 2000</a>) with a peak around 480 nm (<a class="reference external" href="https://royalsocietypublishing.org/doi/full/10.1098/rspb.2012.2987">Bailes and Lucas, 2013</a>, and the review by <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0166223613001975">Lucas et al.,
2014</a>). This yields an action spectrum that is consistent with the spectral sensitivities recorded for melanopsin-driven responses in several other mammalian species (including primates) (<a class="reference external" href="https://www.science.org/doi/abs/10.1126/science.1067262">Berson et al., 2002</a>; <a class="reference external" href="https://www.nature.com/articles/nature03387">Dacey et al., 2005</a>; <a class="reference external" href="https://www.nature.com/articles/nn0601_621">Lucas et al., 2001</a>). Moreover, the
action spectrum for a persistent pupil constriction in humans following a bright light flash (the so-called post-illumination pupil response), which has been attributed to melanopsin in primates, is consistent with the template-based melanopsin action spectrum (<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0042698906005682">Gamlin et al., 2007</a>).</p></li>
<li><p>The physical self-screening adjustment to account for the optical pigment density of melanopsin in ipRGCs is considered negligible.</p></li>
<li><p>A pre-receptoral filtering adjustment is applied to account for the optical path to the peripheral retina. This adjustment is based on the pre-receptoral filtering for a reference observer of age 32 years as adopted in (<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0166223613001975">Lucas et al., 2014</a>) and detailed in (CIE, 2015). Moreover, the influence of macular pigment on the melanopsin action spectrum is considered negligible (i.e. there is no allowance for macular pigment in
<span class="math notranslate nohighlight">\(S_{mel}(\lambda)\)</span>).</p></li>
<li><p>The melanopsin action spectrum as obtained in Step 3 is adjusted from the spectral photon system to the spectral (energy-based) radiometric system.</p></li>
<li><p>The melanopsin action spectrum as obtained in Step 4 is normalized to have a maximum value of 1. This contrasts with <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0166223613001975">Lucas et al. (2014)</a>, where the melanopsin sensitivity function (of Step 4) is normalized so that an equi-energy source (E) with a given illuminance would produce the same spectrally weighted quantities for all five photoreceptors.</p></li>
</ol>
<p>An additional potential consideration in defining the melanopic action spectrum is the possibility that melanopsin may be a so-called bi (or tri) stable photopigment (<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0896627315001002">Emanuel and Do, 2015</a>). Bistable pigments form a thermally stable state upon light exposure that is itself light sensitive and can switch off signalling upon photon absorption. In such pigments, responses to one wavelength of light can be strongly impacted by
exposure to a second wavelength to which the photoproduct is very sensitive. In theory then, estimates of melanopsin spectral sensitivity based upon action spectra derived from exposure to narrow-band or monochromatic sources are not necessarily predictive for responses to polychromatic stimuli. In practice, explicit tests of this possibility have indicated that it is not a significant consideration in vivo (<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0042698906005682">Gamlin et al.,
2007</a>; <a class="reference external" href="https://journals.sagepub.com/doi/abs/10.1177/0748730411409719">Enezi et al., 2011</a>; <a class="reference external" href="https://royalsocietypublishing.org/doi/full/10.1098/rspb.2012.2987">Bailes and Lucas, 2013</a>; <a class="reference external" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0053583">Brown et al., 2013</a>).</p>
</section>
<section id="A.5-Pre-receptoral-filtering-and-spectral-age-correction-(from-CIE-S-026/E:2018)">
<h2>A.5 Pre-receptoral filtering and spectral age correction (from CIE S 026/E:2018)<a class="headerlink" href="#A.5-Pre-receptoral-filtering-and-spectral-age-correction-(from-CIE-S-026/E:2018)" title="Permalink to this heading">¶</a></h2>
<p>The human lens becomes less transparent and yellows with age (<a class="reference external" href="https://opg.optica.org/ao/abstract.cfm?uri=ao-26-8-1437">Pokorny et al., 1987</a>). The action spectra provided in (<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0166223613001975">Lucas et al. (2014)</a>) are based on pre-receptoral filtering for a reference observer of age 32 years, chosen as to be comparable to the age of the CIE 1931 standard colorimetric observer, see also (CIE, 2015). For observers of a different age a
spectral correction may be applied. The correction can be based on the age-dependent transmittance function (CIE, 2012). It is emphasized that these corrections apply to averages, as there is considerable individual variation (<a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/0042698987901660">Mellerio, 1987</a>) and ageing of the lens accelerates in tropical environments (<a class="reference external" href="https://febs.onlinelibrary.wiley.com/doi/abs/10.1016/0014-5793(94)00635-0">Luthra et al., 1994</a>). People who have
undergone cataract surgery can have an increased transmittance in the short wavelength range and may need a dedicated spectral correction for their pre-receptoral filtering.</p>
<p>In September 2012, the CIE published an erratum to (CIE, 2012), which gives the approximate function for the absolute transmission of the human eye for wavelengths from 300 nm to 700 nm for large field sizes. However, this function is considered to remain broadly valid up to 780 nm. Therefore, the function has been applied up to 780 nm to calculate the age-related data in Figure A.1 and Table A.3. Note that this approach is slightly different to the one used in <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0166223613001975">Lucas et
al. (2014)</a> and to the one used in (CIE, 2006).</p>
<p>Since the absolute transmittance for a 32-year-old observer is already included in the melanopic action spectrum, <span class="math notranslate nohighlight">\(S_{mel}(\lambda)\)</span>, it follows that when determining the correction function for age, this correction, too, has to be related to a 32-year-old reference observer. This is done by defining the correction function to be 1 at all wavelengths for <span class="math notranslate nohighlight">\(\alpha\)</span> = 32 years and calculating the spectral correction function <span class="math notranslate nohighlight">\(c(a,\lambda)\)</span> for wavelength <span class="math notranslate nohighlight">\(\lambda\)</span> and age
<span class="math notranslate nohighlight">\(\alpha\)</span> from the ratio of the transmittance function <span class="math notranslate nohighlight">\(S_{mel}(\lambda)\)</span> to the transmittance function <span class="math notranslate nohighlight">\(\tau(32, \lambda)\)</span> for age 32 years, these transmittance functions being as defined by CIE (2012).</p>
<p><span class="math notranslate nohighlight">\(c(\alpha,\lambda) = \frac{\tau(\alpha, \lambda)}{\tau(32, \lambda)}\)</span></p>
<img alt="_images/mel_spectral_correction_function.png" src="_images/mel_spectral_correction_function.png" />
</section>
<section id="My-implementation">
<h2>My implementation<a class="headerlink" href="#My-implementation" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>

<span class="kn">from</span> <span class="nn">pysilsub.CIE</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_CIEPO06_optical_density</span><span class="p">,</span>
    <span class="n">get_CIEPO06_macula_density</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pysilsub.observers</span> <span class="kn">import</span> <span class="n">StandardColorimetricObserver</span>

<span class="c1"># Get density spectra for lens and other ocular media</span>
<span class="n">lomd</span> <span class="o">=</span> <span class="n">get_CIEPO06_optical_density</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

<span class="c1"># Function to correct for age</span>
<span class="k">def</span> <span class="nf">get_lens_density_spectrum</span><span class="p">(</span><span class="n">age</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">age</span> <span class="o">&lt;=</span> <span class="mf">60.0</span><span class="p">:</span>
        <span class="n">correct_lomd</span> <span class="o">=</span> <span class="n">lomd</span><span class="p">[</span><span class="s2">&quot;D_ocul_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="p">(</span><span class="n">age</span> <span class="o">-</span> <span class="mi">32</span><span class="p">))</span> <span class="o">+</span> <span class="n">lomd</span><span class="p">[</span><span class="s2">&quot;D_ocul_2&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">correct_lomd</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">lomd</span><span class="p">[</span><span class="s2">&quot;D_ocul_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mf">1.56</span> <span class="o">+</span> <span class="mf">0.0667</span> <span class="o">*</span> <span class="p">(</span><span class="n">age</span> <span class="o">-</span> <span class="mi">60</span><span class="p">))</span> <span class="o">+</span> <span class="n">lomd</span><span class="p">[</span><span class="s2">&quot;D_ocul_2&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">correct_lomd</span>

<span class="c1"># Wavelength range</span>
<span class="n">wls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># 32 year standard</span>
<span class="n">ld32</span> <span class="o">=</span> <span class="n">get_lens_density_spectrum</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">t32</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">ld32</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>  <span class="c1"># transmittance</span>

<span class="c1"># Spectral correction functions</span>
<span class="n">ages</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
<span class="n">corrections</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">age</span> <span class="ow">in</span> <span class="n">ages</span><span class="p">:</span>
    <span class="n">ld</span> <span class="o">=</span> <span class="n">get_lens_density_spectrum</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>  <span class="c1"># density</span>
    <span class="n">lt</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="n">ld</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>  <span class="c1"># transmittance</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">lt</span><span class="o">/</span><span class="n">t32</span>  <span class="c1"># spectral correction function</span>
    <span class="n">interpfunc</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)</span>  <span class="c1"># problem??</span>
    <span class="n">corrections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interpfunc</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">401</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">corrections</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mel_spectral_correction_2_0.png" src="_images/mel_spectral_correction_2_0.png" />
</div>
</div>
</section>
<section id="Spectral-correction-of-standard-observer-melopsin-action-spectrum">
<h2>Spectral correction of standard observer melopsin action spectrum<a class="headerlink" href="#Spectral-correction-of-standard-observer-melopsin-action-spectrum" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standard_observer</span> <span class="o">=</span> <span class="n">StandardColorimetricObserver</span><span class="p">()</span>

<span class="n">mel</span> <span class="o">=</span> <span class="n">standard_observer</span><span class="o">.</span><span class="n">action_spectra</span><span class="o">.</span><span class="n">mel</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>


<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corrections</span><span class="p">)))</span>
<span class="n">corrected_mel</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">age</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">corrections</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">mel</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">))</span>  <span class="c1"># Apply spectral correction</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>  <span class="c1"># Normalise</span>
    <span class="n">new</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">age</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">corrected_mel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">mel</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;standard observer (32)&#39;</span><span class="p">)</span>
<span class="n">nomogram</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;~/Code/test.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">nomogram</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nomogram</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Govardovskii nomogram&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>

<span class="n">lmax</span> <span class="o">=</span> <span class="p">[</span><span class="n">wls</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">corrected_mel</span><span class="p">]</span>
<span class="n">ylocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">))</span>
<span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ylocs</span><span class="p">,</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mel_spectral_correction_4_0.png" src="_images/mel_spectral_correction_4_0.png" />
</div>
</div>
</section>
<section id="Bit-different-to-Manuel’s-paper…">
<h2>Bit different to Manuel’s paper…<a class="headerlink" href="#Bit-different-to-Manuel’s-paper…" title="Permalink to this heading">¶</a></h2>
<img alt="_images/melanopsin_action_spectrum_spitschan.png" src="_images/melanopsin_action_spectrum_spitschan.png" />
</section>
</section>
<section id="There-is-an-alternative-lens-function">
<h1>There is an alternative lens function<a class="headerlink" href="#There-is-an-alternative-lens-function" title="Permalink to this heading">¶</a></h1>
<p>For some reason, a different function is used for melanopsin. Using this function, lens density correction functions look more like those from the standard.</p>
<p><span class="math">\begin{multline*}
D_{\tau, media}(\lambda) = (0.15 + 0.000031 \cdot a^2) \cdot (400/(\lambda))4\\
+ 14.19 \times 10.68 \cdot exp( – {[ 0.057 \cdot (\lambda\ – 273)]2 })\\
+ (1.05 – 0.000 063 \cdot a2) \cdot 2.13 \cdot exp( – {[0.029 \cdot (\lambda – 370)]2 })\\
+ (0.059 + 0.000 186 \cdot a2) \cdot 11.95 \cdot exp( – {[0.021 \cdot (\lambda– 325)]2 })\\
+ (0.016 + 0.000 132 \cdot a2) \cdot 1.43 \cdot exp( – {[0.008 \cdot (\lambda – 325)]2 }) + 0.06
\end{multline*}</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="k">def</span> <span class="nf">get_CIE_203_2012_lens_density</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">wls</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span><span class="mf">0.15</span> <span class="o">+</span> <span class="mf">0.000031</span> <span class="o">*</span> <span class="p">(</span><span class="n">age</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">400</span> <span class="o">/</span> <span class="n">wls</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>
        <span class="o">+</span> <span class="p">(</span><span class="mf">14.19</span> <span class="o">*</span> <span class="mf">10.68</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="mf">0.057</span> <span class="o">*</span> <span class="p">(</span><span class="n">wls</span> <span class="o">-</span> <span class="mi">273</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="o">+</span> <span class="p">(</span><span class="mf">1.05</span> <span class="o">-</span> <span class="mf">0.000063</span> <span class="o">*</span> <span class="p">(</span><span class="n">age</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="o">*</span> <span class="mf">2.13</span>
        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="mf">0.029</span> <span class="o">*</span> <span class="p">(</span><span class="n">wls</span> <span class="o">-</span> <span class="mi">370</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="o">+</span> <span class="p">(</span><span class="mf">0.059</span> <span class="o">+</span> <span class="mf">0.000186</span> <span class="o">*</span> <span class="p">(</span><span class="n">age</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="o">*</span> <span class="mf">11.95</span>
        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="mf">0.021</span> <span class="o">*</span> <span class="p">(</span><span class="n">wls</span> <span class="o">-</span> <span class="mi">325</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="o">+</span> <span class="p">(</span><span class="mf">0.016</span> <span class="o">+</span> <span class="mf">0.000132</span> <span class="o">*</span> <span class="p">(</span><span class="n">age</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="o">*</span> <span class="mf">1.43</span>
        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="mf">0.008</span> <span class="o">*</span> <span class="p">(</span><span class="n">wls</span> <span class="o">-</span> <span class="mi">325</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.06</span><span class="p">)</span>
    <span class="p">)</span>
<br/></pre></div>
</div>
</div>
<img alt="_images/mel_spectral_correction_function.png" src="_images/mel_spectral_correction_function.png" />
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wavelength range</span>
<span class="n">wls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 32 year standard</span>
<span class="n">ld32</span> <span class="o">=</span> <span class="n">get_CIE_203_2012_lens_density</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">wls</span><span class="p">)</span>
<span class="n">t32</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">ld32</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>  <span class="c1"># transmittance</span>

<span class="c1"># Spectral correction functions</span>
<span class="n">wls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ages</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="n">corrections</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">age</span> <span class="ow">in</span> <span class="n">ages</span><span class="p">:</span>
    <span class="n">ld</span> <span class="o">=</span> <span class="n">get_CIE_203_2012_lens_density</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">wls</span><span class="p">)</span>  <span class="c1"># density</span>
    <span class="n">lt</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="n">ld</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>  <span class="c1"># transmittance</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lt</span><span class="o">/</span><span class="n">t32</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wls</span><span class="p">)</span>  <span class="c1"># spectral correction function</span>
    <span class="n">interpfunc</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)</span>  <span class="c1"># problem??</span>
    <span class="n">corrections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interpfunc</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">401</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">corrections</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">.2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">7801</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">380</span><span class="p">,</span><span class="mi">780</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mel_spectral_correction_10_0.png" src="_images/mel_spectral_correction_10_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standard_observer</span> <span class="o">=</span> <span class="n">StandardColorimetricObserver</span><span class="p">()</span>

<span class="n">mel</span> <span class="o">=</span> <span class="n">standard_observer</span><span class="o">.</span><span class="n">action_spectra</span><span class="o">.</span><span class="n">mel</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>


<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corrections</span><span class="p">)))</span>
<span class="n">corrected_mel</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">age</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">corrections</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">mel</span> <span class="o">*</span> <span class="n">c</span> <span class="c1"># (10**-np.exp(-c))  # Apply spectral correction</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>  <span class="c1"># Normalise</span>
    <span class="n">new</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">age</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">corrected_mel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">mel</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;standard observer (32)&#39;</span><span class="p">)</span>
<span class="n">nomogram</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;~/Code/test.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">nomogram</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nomogram</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Govardovskii nomogram&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>

<span class="n">lmax</span> <span class="o">=</span> <span class="p">[</span><span class="n">wls</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">corrected_mel</span><span class="p">]</span>
<span class="n">ylocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">))</span>
<span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ylocs</span><span class="p">,</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mel_spectral_correction_11_0.png" src="_images/mel_spectral_correction_11_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standard_observer</span> <span class="o">=</span> <span class="n">StandardColorimetricObserver</span><span class="p">()</span>
<span class="n">wls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mel</span> <span class="o">=</span> <span class="n">standard_observer</span><span class="o">.</span><span class="n">action_spectra</span><span class="o">.</span><span class="n">mel</span>
<span class="n">uncmel</span> <span class="o">=</span> <span class="n">mel</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="n">get_CIE_203_2012_lens_density</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">wls</span><span class="p">))</span><span class="o">*</span><span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>


<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corrections</span><span class="p">)))</span>
<span class="n">corrected_mel</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">age</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ld</span> <span class="o">=</span> <span class="n">get_CIE_203_2012_lens_density</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">wls</span><span class="p">)</span>  <span class="c1"># density</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="n">ld</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span>  <span class="c1"># transmittance</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">uncmel</span> <span class="o">*</span> <span class="n">c</span>  <span class="c1"># Apply spectral correction</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>  <span class="c1"># Normalise</span>
    <span class="n">new</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">age</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">corrected_mel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">mel</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;standard observer (32)&#39;</span><span class="p">)</span>
<span class="c1">#ax.plot(wls, uncmel, c=&#39;k&#39;, ls=&#39;:&#39;, label=&#39;standard observer (32)&#39;)</span>

<span class="n">nomogram</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;~/Code/test.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">nomogram</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nomogram</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Govardovskii nomogram&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>

<span class="n">lmax</span> <span class="o">=</span> <span class="p">[</span><span class="n">wls</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">corrected_mel</span><span class="p">]</span>
<span class="n">ylocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">))</span>
<span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ylocs</span><span class="p">,</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mel_spectral_correction_12_0.png" src="_images/mel_spectral_correction_12_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standard_observer</span> <span class="o">=</span> <span class="n">StandardColorimetricObserver</span><span class="p">()</span>

<span class="n">mel</span> <span class="o">=</span> <span class="n">standard_observer</span><span class="o">.</span><span class="n">action_spectra</span><span class="o">.</span><span class="n">mel</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>


<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corrections</span><span class="p">)))</span>
<span class="n">corrected_mel</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">age</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">corrections</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">mel</span> <span class="o">*</span> <span class="n">c</span> <span class="c1"># (10**-np.exp(-c))  # Apply spectral correction</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>  <span class="c1"># Normalise</span>
    <span class="n">new</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">age</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">corrected_mel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">mel</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;standard observer (32)&#39;</span><span class="p">)</span>
<span class="n">nomogram</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;~/Code/test.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">nomogram</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nomogram</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Govardovskii nomogram&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>

<span class="n">lmax</span> <span class="o">=</span> <span class="p">[</span><span class="n">wls</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">corrected_mel</span><span class="p">]</span>
<span class="n">ylocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">))</span>
<span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ylocs</span><span class="p">,</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mel_spectral_correction_13_0.png" src="_images/mel_spectral_correction_13_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rh</span> <span class="o">=</span> <span class="n">standard_observer</span><span class="o">.</span><span class="n">action_spectra</span><span class="o">.</span><span class="n">rh</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>


<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corrections</span><span class="p">)))</span>
<span class="n">corrected_rh</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">age</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">corrections</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">rh</span> <span class="o">*</span> <span class="n">c</span> <span class="c1"># (10**-np.exp(-c))  # Apply spectral correction</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>  <span class="c1"># Normalise</span>
    <span class="n">new</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">age</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">corrected_rh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;standard observer (32)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>

<span class="n">lmax</span> <span class="o">=</span> <span class="p">[</span><span class="n">wls</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">corrected_rh</span><span class="p">]</span>
<span class="n">ylocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">))</span>
<span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ylocs</span><span class="p">,</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mel_spectral_correction_14_0.png" src="_images/mel_spectral_correction_14_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/photoreceptor_characters.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="index.html">PySilSub</a></h1>



<p class="blurb">A Python software for performing the method of silent substitution.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=PySilentSubstitution&repo=pysilsub&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="01_background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_project_notes.html">Project notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_funding.html">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_citation.html">Citation</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://pypi.org/project/pysilsub/">PyPi</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Joel T. Martin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/mel_spectral_correction.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>