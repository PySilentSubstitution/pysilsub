
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>API Documentation &#8212; PySilSub 0.0.14 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Project notes" href="07_project_notes.html" />
    <link rel="prev" title="Cones in the shadow of retinal blood vessels" href="05d_penumbral_cones.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-pysilsub.observers">
<span id="api-documentation"></span><h1>API Documentation<a class="headerlink" href="#module-pysilsub.observers" title="Permalink to this heading">¶</a></h1>
<section id="pysilsub-observers">
<h2><code class="docutils literal notranslate"><span class="pre">pysilsub.observers</span></code><a class="headerlink" href="#pysilsub-observers" title="Permalink to this heading">¶</a></h2>
<p>Colorimetric observer model based on CIEPO06 and CIES026.</p>
<p>Translated from…</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pysilsub.observers.ObserverError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pysilsub.observers.</span></span><span class="sig-name descname"><span class="pre">ObserverError</span></span><a class="headerlink" href="#pysilsub.observers.ObserverError" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic Python-exception-derived object.</p>
<p>Raised programmatically by Observer class methods when arguments are
incorrectly specified or when they do not agree with values of other.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pysilsub.observers.ColorimetricObserver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pysilsub.observers.</span></span><span class="sig-name descname"><span class="pre">ColorimetricObserver</span></span><a class="headerlink" href="#pysilsub.observers.ColorimetricObserver" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="pysilsub.observers.ColorimetricObserver.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penumbral_cones</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.observers.ColorimetricObserver.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>age</strong> (<em>int</em><em> | </em><em>float</em>) – </p></li>
<li><p><strong>field_size</strong> (<em>int</em><em> | </em><em>float</em>) – </p></li>
<li><p><strong>penumbral_cones</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.observers.ColorimetricObserver.adjust_lms">
<span class="sig-name descname"><span class="pre">adjust_lms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.observers.ColorimetricObserver.adjust_lms" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust LMS spectral sensetivities for age and field size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>age</strong> (<em>int</em>) – Observer age.</p></li>
<li><p><strong>field_size</strong> (<em>int</em>) – Field size of the stimulus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>lms_bar_norm</strong> – Adjusted LMS spectral sensitivites.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.observers.ColorimetricObserver.adjust_melanopsin">
<span class="sig-name descname"><span class="pre">adjust_melanopsin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.observers.ColorimetricObserver.adjust_melanopsin" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust melanopsin action spectrum for observer age.</p>
<p>After CIE:, we use a different lens density spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_mel</strong> – Melanopic action spectrum adjusted for age.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.observers.ColorimetricObserver.adjust_rhodopsin">
<span class="sig-name descname"><span class="pre">adjust_rhodopsin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.observers.ColorimetricObserver.adjust_rhodopsin" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust rhodopsin action spectrum for observer age.</p>
<p>After CIE:, we use a different lens density spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_rod</strong> – Rhodopic action spectrum adjusted for age.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.observers.ColorimetricObserver.add_penumbral_cones">
<span class="sig-name descname"><span class="pre">add_penumbral_cones</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.observers.ColorimetricObserver.add_penumbral_cones" title="Permalink to this definition">¶</a></dt>
<dd><p>Include spectral sensitivities for penumbral cones.</p>
<p>Penumbral cones are cones that lie in the shadow of retinal blood
vessels and have altered spectral sensitivity functions due to
prefiltering of light by hemoglobin.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<span class="target" id="module-pysilsub.devices"></span><section id="pysilsub-devices">
<h2><code class="docutils literal notranslate"><span class="pre">pysilsub.devices</span></code><a class="headerlink" href="#pysilsub-devices" title="Permalink to this heading">¶</a></h2>
<p>Software model for multiprimary stimulation devices.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDeviceError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pysilsub.devices.</span></span><span class="sig-name descname"><span class="pre">StimulationDeviceError</span></span><a class="headerlink" href="#pysilsub.devices.StimulationDeviceError" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic Python-exception-derived object.</p>
<p>Raised programmatically by <code class="docutils literal notranslate"><span class="pre">StimulationDevice</span></code> methods when arguments do
not agree with internal parameters and those used to instantiate the class.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pysilsub.devices.</span></span><span class="sig-name descname"><span class="pre">StimulationDevice</span></span><a class="headerlink" href="#pysilsub.devices.StimulationDevice" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic class for calibrated multiprimary stimultion device.</p>
<p>Includes methods to visualise and predict data for a calibrated
multiprimary system.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calibration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_wavelengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_resolutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_colors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CIE_standard_observer'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate class with specified parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calibration</strong> (<em>str</em><em> or </em><em>pd.DataFrame</em>) – DataFrame or path to CSV file with spectral measurements to
characterise the output of the device. Column headers must be
wavelengths and each row a spectrum. Additional columns are needed
to identify the Primary/Setting. For example,
380, 381, …, 780, Primary, Setting. See
<a class="reference external" href="https://pysilentsubstitution.github.io/pysilsub/03a_stimulation_devices.html#pysilsub.device.StimulationDevice">here</a>
for further info. See also <cite>cls.load_calibration_file()</cite></p></li>
<li><p><strong>calibration_wavelengths</strong> (<em>sequence of int</em>) – [start, stop, step] of wavelength range, e.g., [380, 781, 1] for
380 to 780 in 1 nm bins. The default is None, in which case the
wavelength range is determined from the calibration spds.</p></li>
<li><p><strong>primary_resolutions</strong> (<em>sequence of int</em>) – Resolution depth of primaries, i.e., the number of steps available
for specifying the intensity of each primary. This is a list of
integers to allow for systems where primaries may have different
resolution depths. The number of elements must equal the number of
device primaries.</p></li>
<li><p><strong>primary_colors</strong> (<em>sequence of str</em><em> or </em><em>rgb</em>) – Sequence of valid color names for the primaries. Must be in
<a class="reference external" href="https://matplotlib.org/stable/gallery/color/named_colors.html">matplotlib.colors.cnames</a>.
Alternatively, pass a sequence of RGB values.</p></li>
<li><p><strong>observer</strong> (<em>str</em><em> or </em><em>pysilsub.observer.Observer</em>) – Colorimetric observer model. The default is “CIE_standard_observer”
, in which case defaults to the CIE standard colorimetric observer
model (age=32, field_size=10), but can pass a custom observer
model.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the device or stimulation system, e.g., <cite>8-bit BCGAR
photostimulator</cite>. The default name is <cite>Stimulation Device</cite>.</p></li>
<li><p><strong>config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional information from the config file. The default is
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.from_json">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_json</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct class from preformatted json config file.</p>
<p>See <cite>pysilsub.config</cite> for further details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config_json</strong> (<em>str</em>) – json file with configuration parameters for <cite>StimulationDevice</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>pysilsub.StimulationDevice</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.from_package_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_package_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.from_package_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct class from example package data.</p>
<p>For further details:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">show_package_data</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>str</em>) – <p>Currently the following options are available:</p>
<blockquote>
<div><ul class="simple">
<li><p>’STLAB_York’</p></li>
<li><p>’STLAB_Oxford’</p></li>
<li><p>’BCGAR’</p></li>
<li><p>’VirtualSky’</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pysilsub.devices.StimulationDevice" title="pysilsub.devices.StimulationDevice"><em>StimulationDevice</em></a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">device</span> <span class="pre">=</span> <span class="pre">StimulationDevice.from_package_example('BCGAR')</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>pysilsub.StimulationDevice</cite></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>class</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>str</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.show_package_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">show_package_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.show_package_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Show details of example data in the package distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Print detailed information if True. The default is False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Available package data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.load_calibration_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_calibration_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calibration_fpath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.load_calibration_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load calibration file into pandas DataFrame.</p>
<p>First row must contain column headers <em>Primary</em> and <em>Setting</em> and
numbers to describe the wavelength sampling (e.g., Primary, Setting,
380, 381, …, 780). All remaining rows row should contain a spectral
measurement and the corresponding values for <em>Primary</em> and <em>Setting</em>
to identify the measurement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>calibration_fpath</strong> (<em>str</em>) – Path to CSV file with correct format (see above).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>calibration</strong> – DataFrame with Multi-Index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.plot_gamut">
<span class="sig-name descname"><span class="pre">plot_gamut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_1931_horseshoe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_CIE170_2_horseshoe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.plot_gamut" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the gamut of the stimulation device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – Axes on which to plot. The default is None.</p></li>
<li><p><strong>show_1931_horseshoe</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to show the CIE1931 chromaticity horseshoe. The default is
True.</p></li>
<li><p><strong>show_CIE170_2_horseshoe</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to show the CIE170_2 chromaticity horseshoe. The default is
True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.plot_calibration_spds">
<span class="sig-name descname"><span class="pre">plot_calibration_spds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.plot_calibration_spds" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the spectral power distributions for the stimulation device.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ax</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib.axes.Axes</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>Axes</em><em>]</em>) – </p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.plot_calibration_spds_and_gamut">
<span class="sig-name descname"><span class="pre">plot_calibration_spds_and_gamut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamut_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.plot_calibration_spds_and_gamut" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot calibration SPDs alongside gamut on CIE chromaticity horseshoe.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fig</strong> – The figure.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>plt.Figure</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spd_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>]</em>) – </p></li>
<li><p><strong>gamut_kwargs</strong> (<em>Optional</em><em>[</em><em>dict</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.predict_primary_spd">
<span class="sig-name descname"><span class="pre">predict_primary_spd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.predict_primary_spd" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict output for a single device primary at a given setting.</p>
<p>This is the basis for all predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primary</strong> (<em>int</em>) – Device primary.</p></li>
<li><p><strong>primary_input</strong> (<em>int</em><em> or </em><em>float</em>) – Requested input for device primary. Must be float (&gt;=0.0|&lt;=1.0) or
int (&gt;=0|&lt;=max resolution).</p></li>
<li><p><strong>name</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – A name for the spectrum. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If requested value of primary_input exceeds resolution.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Predicted spd for primary / primary_input.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.predict_multiprimary_spd">
<span class="sig-name descname"><span class="pre">predict_multiprimary_spd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiprimary_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nosum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.predict_multiprimary_spd" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict spectral power distribution for requested primary inputs.</p>
<p>Predict the SPD output of the stimulation device for a given list of
primary inputs. Assumes linear summation of primaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multiprimary_input</strong> (<em>list of int</em><em> or </em><em>float</em>) – Rquested inputs for the device primaries. List of length
<cite>self.nprimaries</cite> consisting of either float (&gt;=0.0|&lt;=1.0) or
int (&gt;=0|&lt;=max resolution).</p></li>
<li><p><strong>name</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – A name for the spectrum, e.g. ‘Background’. The default is 0.</p></li>
<li><p><strong>nosum</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to sum the primary components of the spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the number of elements in <cite>settings</cite> is greater than the number
    of device primaries.
    
    If the elements in <cite>settings</cite> are not exclusively int or float.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Predicted spectra or spectrum for given device settings.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame if nosum=True else pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.calculate_aopic_irradiances">
<span class="sig-name descname"><span class="pre">calculate_aopic_irradiances</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.calculate_aopic_irradiances" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate aopic irradiances from calibration spds.</p>
<p>Using the CIE026 spectral sensetivities, calculate alpha-opic
irradiances (S, M, L, R, I) for every spectrum in <cite>self.calibration</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Alphaopic irradiances.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.calculate_lux">
<span class="sig-name descname"><span class="pre">calculate_lux</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.calculate_lux" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the CIE1924 photopic luminosity function, calculate lux for
every spectrum in <cite>self.calibration</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Lux values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.predict_multiprimary_aopic">
<span class="sig-name descname"><span class="pre">predict_multiprimary_aopic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiprimary_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.predict_multiprimary_aopic" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict a-opic irradiances of device for requested primary inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multiprimary_input</strong> (<em>list of int</em><em> or </em><em>float</em>) – Rquested inputs for the device primaries. List of length
<cite>self.nprimaries</cite> consisting of either float (&gt;=0.0|&lt;=1.0) or
int (&gt;=0|&lt;=max resolution).</p></li>
<li><p><strong>name</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – A name for the output, e.g. ‘Background’. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>aopic</strong> – Predicted a-opic irradiances for given device settings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.find_settings_xyY">
<span class="sig-name descname"><span class="pre">find_settings_xyY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">luminance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_solution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.find_settings_xyY" title="Permalink to this definition">¶</a></dt>
<dd><p>Find device settings for a spectrum with requested xyY values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> (<em>sequence of float</em>) – Requested chromaticity coordinates (xy).</p></li>
<li><p><strong>luminance</strong> (<em>float</em>) – Requested luminance.</p></li>
<li><p><strong>tolerance</strong> (<em>float</em><em>, </em><em>optional</em>) – Acceptable precision for result.</p></li>
<li><p><strong>plot_solution</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to True to plot the solution. The default is False.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to True to print status messages. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError if len</strong><strong>(</strong><strong>xy</strong><strong>) </strong><strong>!= 2</strong> – </p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>result</strong> – The result of the optimisation procedure, with result.x as the
settings that will produce the spectrum.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>OptimizeResult</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.do_gamma">
<span class="sig-name descname"><span class="pre">do_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'polynomial'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.do_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a gamma table from reverse polynomial or beta cdf curve fits.</p>
<p>For each primary, calculate the unweigthed sum of the spectral
calibration measurements (output) at each setting (input). A reverse
curve fit on these data gives the new input values required for
linearisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘polynomial’ or ‘beta_cdf’. The default is ‘polynomial’.</p></li>
<li><p><strong>save_plots_to</strong> (<em>str</em><em>, </em><em>optional</em>) – Folder to save plots in. The default is None.</p></li>
<li><p><strong>force_origin</strong> (<em>bool</em>) – </p></li>
<li><p><strong>poly_order</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.plot_gamma">
<span class="sig-name descname"><span class="pre">plot_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_plots_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_corrected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.plot_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot gamma results for each primary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_plots_to</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to folder where plots should be saved. The default is None.</p></li>
<li><p><strong>show_corrected</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to show gamma corrected predicted values in the plots. The
default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.gamma_lookup">
<span class="sig-name descname"><span class="pre">gamma_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.gamma_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Look up the gamma corrected value for a primary input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primary</strong> (<em>int</em>) – Device primary.</p></li>
<li><p><strong>primary_input</strong> (<em>int</em><em> or </em><em>float</em>) – Requested input for device primary. Must be float (&gt;=0.0|&lt;=1.0) or
int (&gt;=0|&lt;=max resolution).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gamma corrected primary input value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.gamma_correct">
<span class="sig-name descname"><span class="pre">gamma_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiprimary_input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.gamma_correct" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the gamma corrected values for multiprimary device input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>multiprimary_input</strong> (<em>Sequence of int</em><em> or </em><em>float</em>) – Rquested inputs for the device primaries. List of length
<cite>self.nprimaries</cite> consisting of either float (&gt;=0.0|&lt;=1.0) or
int (&gt;=0|&lt;=max resolution).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gamma corrected multiprimary input values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.s2w">
<span class="sig-name descname"><span class="pre">s2w</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.s2w" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert settings to weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>settings</strong> (<em>Sequence of int</em>) – List of length <cite>self.nprimaries</cite> containing device settings
ranging from 0 to max-resolution for each primary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of primary weights.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.devices.StimulationDevice.w2s">
<span class="sig-name descname"><span class="pre">w2s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.devices.StimulationDevice.w2s" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert weights to settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>weights</strong> (<em>Sequence of float</em>) – List of length <cite>self.nprimaries</cite> containing primary input weights,
ranging from 0. to 1., for each primary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of primary settings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<span class="target" id="module-pysilsub.problems"></span><section id="pysilsub-problems">
<h2><code class="docutils literal notranslate"><span class="pre">pysilsub.problems</span></code><a class="headerlink" href="#pysilsub-problems" title="Permalink to this heading">¶</a></h2>
<p>Definine, solve and visualise silent substitution problems for a given observer
and multiprimary stimulation device.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pysilsub.problems.SilSubProblemError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pysilsub.problems.</span></span><span class="sig-name descname"><span class="pre">SilSubProblemError</span></span><a class="headerlink" href="#pysilsub.problems.SilSubProblemError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic Python-exception-derived object.</p>
<p>Raised programmatically by <code class="docutils literal notranslate"><span class="pre">SilentSubstitutionProblem</span></code> methods when
arguments are incorrectly specified or when they do not agree with values
of other .</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pysilsub.problems.</span></span><span class="sig-name descname"><span class="pre">SilentSubstitutionProblem</span></span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pysilsub.devices.StimulationDevice" title="pysilsub.devices.StimulationDevice"><code class="xref py py-class docutils literal notranslate"><span class="pre">StimulationDevice</span></code></a></p>
<p>Class to perform silent substitution with a stimulation device.</p>
<p>The class inherits from <code class="docutils literal notranslate"><span class="pre">pysilsub.device.StimulationDevice</span></code> and is
extended with properties and methods to define and solve a silent
substitution problem. After instantiating, set the properties to define a
problem and then use the solver methods to find a solution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysilsub.problem</span> <span class="kn">import</span> <span class="n">SilentSubstitutionProblem</span> <span class="k">as</span> <span class="n">SSP</span>

<span class="c1"># EXAMPLE: 1</span>
<span class="c1"># Using all channels at half-power as the background spectrum,</span>
<span class="c1"># use linear algebra to find a solution that gives 20 % S-cone</span>
<span class="c1"># contrast while ignoring rods and silencing M-cones, L-cones</span>
<span class="c1"># and melanopsin.</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">SSP</span><span class="o">.</span><span class="n">from_package_data</span><span class="p">(</span><span class="s1">&#39;STLAB_York&#39;</span><span class="p">)</span>
<span class="n">problem</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rh&#39;</span><span class="p">]</span>
<span class="n">problem</span><span class="o">.</span><span class="n">modulate</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sc&#39;</span><span class="p">]</span>
<span class="n">problem</span><span class="o">.</span><span class="n">minimize</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mc&#39;</span><span class="p">,</span> <span class="s1">&#39;lc&#39;</span><span class="p">,</span> <span class="s1">&#39;mel&#39;</span><span class="p">]</span>
<span class="n">problem</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.5</span><span class="p">]</span> <span class="o">*</span> <span class="n">problem</span><span class="o">.</span><span class="n">nprimaries</span>
<span class="n">problem</span><span class="o">.</span><span class="n">target_contrast</span> <span class="o">=</span> <span class="mf">.2</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">linalg_solve</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">plot_ss_result</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>

<span class="c1"># EXAMPLE: 2</span>
<span class="c1"># Without specifying a background spectrum, use numerical</span>
<span class="c1"># optimisation to find a pair of spectra which maximise</span>
<span class="c1"># melanopsin contrast while ignoring rods and silencing the</span>
<span class="c1"># cones.</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">SSP</span><span class="o">.</span><span class="n">from_package_data</span><span class="p">(</span><span class="s1">&#39;STLAB_York&#39;</span><span class="p">)</span>
<span class="n">problem</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rh&#39;</span><span class="p">]</span>
<span class="n">problem</span><span class="o">.</span><span class="n">modulate</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mel&#39;</span><span class="p">]</span>
<span class="n">problem</span><span class="o">.</span><span class="n">minimize</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span> <span class="s1">&#39;mc&#39;</span><span class="p">,</span> <span class="s1">&#39;lc&#39;</span><span class="p">]</span>
<span class="n">problem</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">problem</span><span class="o">.</span><span class="n">target_contrast</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">optim_solve</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">plot_ss_result</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calibration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_wavelengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_resolutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_colors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CIE_standard_observer'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate class with specified parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calibration</strong> (<em>str</em><em> or </em><em>pd.DataFrame</em>) – <p>DataFrame or path to CSV file with spectral measurements to
characterise the output of the device. Column headers must be
wavelengths and each row a spectrum. Additional columns are needed
to identify the Primary/Setting. For example,
380, 381, …, 780, Primary, Setting. See
<a class="reference external" href="https://pysilentsubstitution.github.io/pysilsub/03a_stimulation_devices.html#pysilsub.device.StimulationDevice">here</a>
for further info. See also <cite>cls.load_calibration_file()</cite></p>
</p></li>
<li><p><strong>calibration_wavelengths</strong> (<em>sequence of int</em>) – [start, stop, step] of wavelength range, e.g., [380, 781, 1] for
380 to 780 in 1 nm bins. The default is None, in which case the
wavelength range is determined from the calibration spds.</p></li>
<li><p><strong>primary_resolutions</strong> (<em>sequence of int</em>) – Resolution depth of primaries, i.e., the number of steps available
for specifying the intensity of each primary. This is a list of
integers to allow for systems where primaries may have different
resolution depths. The number of elements must equal the number of
device primaries.</p></li>
<li><p><strong>primary_colors</strong> (<em>sequence of str</em><em> or </em><em>rgb</em>) – <p>Sequence of valid color names for the primaries. Must be in
<a class="reference external" href="https://matplotlib.org/stable/gallery/color/named_colors.html">matplotlib.colors.cnames</a>.
Alternatively, pass a sequence of RGB values.</p>
</p></li>
<li><p><strong>observer</strong> (<em>str</em><em> or </em><em>pysilsub.observer.Observer</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>observer</strong> – Colorimetric observer model. The default is “CIE_standard_observer”
, in which case defaults to the CIE standard colorimetric observer
model (age=32, field_size=10).</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the device or stimulation system, e.g., <cite>8-bit BCGAR
photostimulator</cite>. The default name is <cite>Stimulation Device</cite>.</p></li>
<li><p><strong>config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional information from the config file. The default is
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.background">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">background</span></span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.background" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a background spectrum for the silent substitution stimulus.</p>
<p>Setting the <em>background</em> property internally conditions the silent
substitution problem.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">linalg_solve(...)</span></code> only works when a background is specified.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optim_solve(...)</span></code> optimises the background and modulation
spectrum if no background is specified, otherwise it only
optimises the modulation spectrum.</p></li>
</ul>
</div></blockquote>
<p>For example, to use all channels at half power as the background
spectrum:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.5</span><span class="p">]</span> <span class="o">*</span> <span class="n">problem</span><span class="o">.</span><span class="n">nprimaries</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SilSubProblemError if requested but not specified.</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>background</strong> – Primary inputs of the background spectrum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sequence of float or int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.bounds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Define input bounds for each primary.</p>
<p>The <em>bounds</em> property ensures that solutions are within gamut. Bounds
should be defined as a list of tuples of length <code class="docutils literal notranslate"><span class="pre">self.nprimaries</span></code>,
where each tuple consists of a min-max pair of floats <code class="docutils literal notranslate"><span class="pre">(&gt;=0.|&lt;=1.)</span></code>
defining the lower and upper bounds for each channel. Bounds are set
automatically in the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nprimaries</span>
</pre></div>
</div>
<p>If, after creating a problem you want to constrain solutions to avoid
the lower and upper extremes of the input ranges, for example, you
could pass something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">,)]</span> <span class="o">*</span> <span class="n">problem</span><span class="o">.</span><span class="n">nprimaries</span>
</pre></div>
</div>
<p>It is also possible to set different bounds for each primary. This may
be useful if you want to <em>pin</em> a problematic primary so that its value
is constrained during optimisation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_bounds</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">bounds</span>
<span class="n">new_bounds</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.49</span><span class="p">,</span> <span class="mf">.51</span><span class="p">,)</span>
<span class="n">problem</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">new_bounds</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SilSubProblemError if requested but not specified.</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>bounds</strong> – Input bounds for each primary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of float pairs</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.ignore">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ignore</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.ignore" title="Permalink to this definition">¶</a></dt>
<dd><p>Photoreceptor(s) to be ignored.</p>
<p>Setting the <em>ignore</em> property internally conditions the silent
substitution problem such that the specified photoreceptor(s) will be
ignored by the solvers (enabling them to find more contrast). In most
cases <em>ignore</em> will be set to [‘rh’], because it is considered safe
practice to ignore rods when stimuli are in the photopic range
(&gt;300 cd/m2):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rh&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>But you could also choose to ignore rods and melanopsin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span> <span class="s1">&#39;mel&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>In the event that you don’t want to ignore any photoreceptors, you must
still pass:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</pre></div>
</div>
<p>Setting the <em>ignore</em> property is an essential step for conditioning a
silent substitution problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SilSubProblemError if ignore not specified.</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ignore</strong> – Photoreceptors to be ignored.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>[None] or list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.minimize">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">minimize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Photoreceptor(s) to be minimized.</p>
<p>Setting the <em>minimize</em> property internally conditions the silent
substitution problem such that contrast on the target photoreceptors
will be minimized. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">minimize</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span> <span class="s1">&#39;mc&#39;</span><span class="p">,</span> <span class="s1">&#39;lc&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Would minimize contrast on the cone photoreceptors.</p>
<p>Setting the <em>minimize</em> property is an essential step for conditioning a
silent substitution problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SilSubProblemError if requested but not specified.</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>minimize</strong> – Photoreceptor(s) to be minimized.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.modulate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">modulate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.modulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Photoreceptor(s) to modulate.</p>
<p>Setting the <em>modulate</em> property internally conditions the silent
substitution problem so the solvers know which photoreceptor(s) should
be targeted with contrast. For example, to modulate melanopsin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">modulate</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mel&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>It is also possible to modulate multiple photoreceptors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">modulate</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span> <span class="s1">&#39;mc&#39;</span><span class="p">,</span> <span class="s1">&#39;lc&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Setting the <em>modulate</em> property is an essential step for conditioning a
silent substitution problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SilSubProblemError if requested but not specified.</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>modulate</strong> – Photoreceptors to be modulated.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.target_contrast">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">target_contrast</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy._typing._generic_alias.ScalarType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.target_contrast" title="Permalink to this definition">¶</a></dt>
<dd><p>Target contrast to aim for on modulated photoreceptor(s).</p>
<p>Setting the <em>target_contrast</em> property conditions the silent
substitution problem so the solvers know what target contrast to aim
for:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">target_contrast</span> <span class="o">=</span> <span class="mf">.5</span>
</pre></div>
</div>
<p>This would aim for 50% contrast on the modulated photoreceptor(s). If
modulating multiple photoreceptors in different directions and / or
with different contrasts, <em>target_contrast</em> should be a sequence of
values (if you specify multiple receptors to modulate and pass a float
then it is assumed <em>target_contrast</em> should be the same for each
photoreceptor):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rh&#39;</span><span class="p">]</span>
<span class="n">problem</span><span class="o">.</span><span class="n">minimize</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mel&#39;</span><span class="p">]</span>
<span class="n">problem</span><span class="o">.</span><span class="n">modulate</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sc&#39;</span><span class="p">,</span> <span class="s1">&#39;mc&#39;</span><span class="p">,</span> <span class="s1">&#39;lc&#39;</span><span class="p">]</span>
<span class="n">problem</span><span class="o">.</span><span class="n">target_contrast</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">]</span>
</pre></div>
</div>
<p>The above example defines a problem that will ignore rods and aim for
50% negative contrast on S-cones and 50% positive contrast on L- and
M-cones, relative to the background spectrum.</p>
<p>Setting <em>target_contrast</em> is required for <code class="docutils literal notranslate"><span class="pre">linalg_solve()</span></code>.</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">.optim_solve()</span></code>, <em>target_contrast</em> can be set to ‘max’
or ‘min’, in which case the optimizer will aim to maximize or minimize
contrast on the modulated photoreceptors.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SilSubProblemError if requested but not specified.</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>target_contrast</strong> – Contrast to aim for on photoreceptor(s) being modulated.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>NDArray or str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.print_problem">
<span class="sig-name descname"><span class="pre">print_problem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.print_problem" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the current problem definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.initial_guess_x0">
<span class="sig-name descname"><span class="pre">initial_guess_x0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.initial_guess_x0" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial guess of the primary inputs for optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Initial guess for optimization.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.aopic_calculator">
<span class="sig-name descname"><span class="pre">aopic_calculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.aopic_calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate alphaopic irradiances for candidate solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x0</strong> (<em>Sequence of float</em>) – Primary input weights.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bg_aopic</strong> (<em>pd.Series</em>) – Alphaopic irradiances for the background spectrum.</p></li>
<li><p><strong>mod_aopic</strong> (<em>pd.Series</em>) – Alphaopic irradiances for the modulation spectrum.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[pandas.core.series.Series, pandas.core.series.Series]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.print_photoreceptor_contrasts">
<span class="sig-name descname"><span class="pre">print_photoreceptor_contrasts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrast_statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'simple'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.print_photoreceptor_contrasts" title="Permalink to this definition">¶</a></dt>
<dd><p>Print photoreceptor contrasts for a given solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>Sequence</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>contrast_statistic</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.get_photoreceptor_contrasts">
<span class="sig-name descname"><span class="pre">get_photoreceptor_contrasts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrast_statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'simple'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.get_photoreceptor_contrasts" title="Permalink to this definition">¶</a></dt>
<dd><p>Return contrasts for ignored, minimized and modulated photoreceptors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>Sequence of float</em>) – Primary input weights.</p></li>
<li><p><strong>contrast_statistic</strong> (<em>str</em>) – The contrast statistic to return, either ‘simple’, ‘weber’, or
‘michelson’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Photoreceptor contrasts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.objective_function">
<span class="sig-name descname"><span class="pre">objective_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.objective_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates contrast error on modulated photoreceptor(s) in
accordance with the problem definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x0</strong> (<em>Sequence of float</em>) – Primary input weights.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contrast error on modulated photoreceptor(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.silencing_constraint">
<span class="sig-name descname"><span class="pre">silencing_constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.silencing_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate contrast error for minimized photoreceptor(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x0</strong> (<em>Sequence of float</em>) – Primary input weights.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contrast error on minimized photoreceptor(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.optim_solve">
<span class="sig-name descname"><span class="pre">optim_solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.optim_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Use optimisation to solve the current silent substitution problem.</p>
<p>This method is good for finding maximum available contrast. It uses
SciPy’s <cite>minimize</cite> function with the <cite>SLSQP</cite> (sequential quadratic
least squares programming) solver.</p>
<p>If <cite>self.background</cite> has not been set, both the background and the
modulation spectrum are optimised.</p>
<p>If <cite>self.target_contrast</cite> has been set to <cite>np.inf</cite> or <cite>-np.inf</cite>, the
optimser will aim to maximise or minimize contrast, respectively,
otherwise it will aim to converge on the target contrast.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>global_search</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to perform a global search with scipy’s basinhopping
algorithm.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – The result of the optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scipy.optimize.OptimizeResult</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.linalg_solve">
<span class="sig-name descname"><span class="pre">linalg_solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.linalg_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Use linear algebra to solve the current silent substitution problem.</p>
<p>Inverse method is applied when the matrix is square (i.e., when the
number of primaries is equal to the number of photoreceptors),
alternatively the Moore-Penrose pseudo-inverse.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#pysilsub.problems.SilSubProblemError" title="pysilsub.problems.SilSubProblemError"><strong>SilSubProblemError</strong></a> – If <cite>self.background</cite> or <cite>self.target_contrast</cite> are not specified.</p></li>
<li><p><strong>ValueError</strong> – If the solution is outside <cite>self.bounds</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>solution</strong> – Primary weights for the modulation spectrum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.get_solution_spds">
<span class="sig-name descname"><span class="pre">get_solution_spds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.get_solution_spds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get predicted spds for solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solution</strong> (<em>array_like</em>) – The solution returned by one of the solvers.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bg_spd</strong> (<em>pd.Series</em>) – Chromaticity coordinates of background spectrum.</p></li>
<li><p><strong>mod_spd</strong> (<em>pd.Series</em>) – Chromaticity coordinates of modulation spectrum.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.plot_solution_spds">
<span class="sig-name descname"><span class="pre">plot_solution_spds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.plot_solution_spds" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the solution spds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> (<em>array_like</em>) – The solution returned by one of the solvers.</p></li>
<li><p><strong>ax</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – Axes on which to  plot. The default is None.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Passed to <cite>pd.Series.plot()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – Axes on which the data are plotted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.get_solution_xy">
<span class="sig-name descname"><span class="pre">get_solution_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.get_solution_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get xy chromaticity coordinates for solution spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solution</strong> (<em>array_like</em>) – The solution returned by one of the solvers.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bg_xy</strong> (<em>TYPE</em>) – Chromaticity coordinates of background spectrum.</p></li>
<li><p><strong>mod_xy</strong> (<em>TYPE</em>) – Chromaticity coordinates of modulation spectrum.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.plot_solution_xy">
<span class="sig-name descname"><span class="pre">plot_solution_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.plot_solution_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot solution chromaticity coordinates on CIE horseshoe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> (<em>array_like</em>) – The solution returned by one of the solvers.</p></li>
<li><p><strong>ax</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – Axes on which to  plot. The default is None.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Passed to <cite>pd.Series.scatter()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – Axes on which the data are plotted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.plot_solution_aopic">
<span class="sig-name descname"><span class="pre">plot_solution_aopic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.plot_solution_aopic" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot barchart of alphaopic irradiances .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> (<em>array_like</em>) – The solution returned by one of the solvers.</p></li>
<li><p><strong>ax</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – Axes on which to  plot. The default is None.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Passed to <cite>DataFrame.bar.plot()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – Axes on which the data are plotted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.plot_solution">
<span class="sig-name descname"><span class="pre">plot_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.plot_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot solution spds, xy chromaticities and alphaopic irradiances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solution</strong> (<em>array_like</em>) – The solution returned by one of the solvers.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.print_solution">
<span class="sig-name descname"><span class="pre">print_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.print_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the device input settings for the background and modulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solution</strong> (<em>array_like</em>) – The solution returned by one of the solvers.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.make_contrast_modulation">
<span class="sig-name descname"><span class="pre">make_contrast_modulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_contrast</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.make_contrast_modulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a sinusoidal contrast modulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frequency</strong> (<em>int</em><em> | </em><em>float</em>) – Modulation frequency in Hz.</p></li>
<li><p><strong>sampling_frequency</strong> (<em>int</em>) – Sampling frequency of the modulation. This should not exceed the
temporal resolution (spectral switching time) of the stimulation
device.</p></li>
<li><p><strong>target_contrast</strong> (<em>float</em>) – Peak contrast of the modulation for targetted photoreceptor(s).</p></li>
<li><p><strong>phase</strong> (<em>int</em><em> | </em><em>float</em><em>, </em><em>optional</em>) – Phase offset. The default is 0. Use np.pi</p></li>
<li><p><strong>duration</strong> (<em>int</em><em> | </em><em>float</em><em>, </em><em>optional</em>) – Duration of the modulation. The default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>solutions</strong> – Solution for each time point in the modulation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.plot_contrast_modulation">
<span class="sig-name descname"><span class="pre">plot_contrast_modulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.plot_contrast_modulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot photoreceptor contrast over time for a list of solutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>list</em>) – List of solutions returned by one of the solvers (one for each
timepoint in the modulation).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pysilsub.problems.SilentSubstitutionProblem.animate_solutions">
<span class="sig-name descname"><span class="pre">animate_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.problems.SilentSubstitutionProblem.animate_solutions" title="Permalink to this definition">¶</a></dt>
<dd><p>Something here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solutions</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>save_to</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DESCRIPTION.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<span class="target" id="module-pysilsub.colorfuncs"></span><section id="pysilsub-colorfuncs">
<h2><code class="docutils literal notranslate"><span class="pre">pysilsub.colorfuncs</span></code><a class="headerlink" href="#pysilsub-colorfuncs" title="Permalink to this heading">¶</a></h2>
<p>Tools for navigating between colorspaces.</p>
<p>Many have been translated from MATLAB’s Psychtoolbox/PsychColormetric</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.xyY_to_XYZ">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">xyY_to_XYZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.xyY_to_XYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute tristimulus values from chromaticity and luminance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xyY</strong> (<em>Sequence of float</em>) – Array of values representing chromaticity (xy) and luminance (Y).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>XYZ</strong> – Tristimulus values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.XYZ_to_xyY">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">XYZ_to_xyY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">XYZ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.XYZ_to_xyY" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute chromaticity and luminance from tristimulus values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>XYZ</strong> (<em>Sequence of float</em>) – Tristimulus values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>xyY</strong> – Chromaticity coordinates (xy) and luminance (Y).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.XYZ_to_LMS">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">XYZ_to_LMS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">XYZ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.XYZ_to_LMS" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute cone excitation (LMS) coordinates from tristimulus values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>XYZ</strong> (<em>Sequence of float</em>) – Tristimulus values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>LMS coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.LMS_to_XYZ">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">LMS_to_XYZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LMS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.LMS_to_XYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute tristimulus values from cone excitation (LMS) coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>LMS</strong> (<em>Sequence of float</em>) – LMS (cone excitation) coordinates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tristimulus values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.xyY_to_LMS">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">xyY_to_LMS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.xyY_to_LMS" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute cone excitation (LMS) coordinates from chromaticity and luminance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xyY</strong> (<em>Sequence of float</em>) – Array of values representing chromaticity (xy) and luminance (Y).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>LMS coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.LMS_to_xyY">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">LMS_to_xyY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LMS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.LMS_to_xyY" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute xyY coordinates from LMS values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>LMS</strong> (<em>Sequence of float</em>) – LMS (cone excitation) coordinates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of values representing chromaticity (xy) and luminance (Y).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.spd_to_XYZ">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">spd_to_XYZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.spd_to_XYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a spectrum to an XYZ point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spd</strong> (<em>np.array</em><em> or </em><em>pd.Series</em>) – Spectral power distribution in calibrated units..</p></li>
<li><p><strong>binwidth</strong> (<em>int</em><em>, </em><em>optional</em>) – Bin width of the spd in nanometers. The default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tristimulus values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.spd_to_lux">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">spd_to_lux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.spd_to_lux" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a spectrum to luminance (lux).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spd</strong> (<em>np.array</em><em> or </em><em>pd.Series</em>) – Spectral power distribution in calibrated units.</p></li>
<li><p><strong>binwidth</strong> (<em>int</em><em>, </em><em>optional</em>) – Bin width of the spd in nanometers. The default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Luminance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.spd_to_xyY">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">spd_to_xyY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.spd_to_xyY" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute xyY coordinates from spectral power distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spd</strong> (<em>np.array</em><em> or </em><em>pd.Series</em>) – Spectral power distribution in calibrated units.</p></li>
<li><p><strong>binwidth</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>xyY.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.colorfuncs.xy_luminance_to_xyY">
<span class="sig-prename descclassname"><span class="pre">pysilsub.colorfuncs.</span></span><span class="sig-name descname"><span class="pre">xy_luminance_to_xyY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">luminance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.colorfuncs.xy_luminance_to_xyY" title="Permalink to this definition">¶</a></dt>
<dd><p>Return xyY from xy and luminance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> (<em>Sequence of float</em>) – xy chromaticity coordinates.</p></li>
<li><p><strong>luminance</strong> (<em>float</em>) – Luminance in lux or cd/m2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>xyY.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

</section>
<span class="target" id="module-pysilsub.CIE"></span><section id="pysilsub-cie">
<h2><code class="docutils literal notranslate"><span class="pre">pysilsub.CIE</span></code><a class="headerlink" href="#pysilsub-cie" title="Permalink to this heading">¶</a></h2>
<p>Convenience functions for accessing CIE standards.</p>
<p>Obtained from <a class="reference external" href="http://www.cvrl.org/">http://www.cvrl.org/</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_CIE_2006_10_deg_CMF">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_CIE_2006_10_deg_CMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_CIE_2006_10_deg_CMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the CIE 2006 XYZ 10-deg physiologically relevant color matching
functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>binwidth</strong> (<em>int</em>) – Desired width of the wavelength bins in nanometers. The default is <cite>1</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cmf</strong> – CIE 2006 XYZ 10-deg physiologically relevant CMFs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_CIE_1931_2_deg_CMF">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_CIE_1931_2_deg_CMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_CIE_1931_2_deg_CMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the CIE 1931 XYZ 2-deg color matching functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>binwidth</strong> (<em>int</em>) – Desired width of the wavelength bins in nanometers. The default is <cite>1</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cmf</strong> – CIE 1931 XYZ 2-deg CMFs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_CIES026_action_spectra">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_CIES026_action_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_CIES026_action_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Get CIES026 photoreceptor action spectra.</p>
<p>This table contains data for the photoreceptor action spectra of a
standard 32-year-old observer and a 10-degree field size, for wavelengths
from 380 nm to 780 nm. Values are zero where data are presently unavailable
at those wavelengths. The rhodopic action spectrum values are reproduced
from ISO 23539/CIE S 010 without modifications. The S-cone opic action
spectrum is provided for 390 nm to 615 nm, and the M- and L-cone-opic
action spectra are provided for 390 nm to 780 nm, all reproduced from
(CIE, 2006). By definition, the S-, M- and L-cone-opic action spectra take
a maximum value of exactly 1 at 447.9 nm, 541.3 nm and 568.6 nm
respectively. The melanopic action spectrum is reproduced from the
underlying model in the Toolbox from (CIE, 2015), interpolated (cubic
spline) from 5 nm to 1 nm resolution, and rounded to the nearest six
significant figures for consistency with the cone fundamentals in (CIE,
2006).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Further information on the CIES026 standard is available
<a class="reference external" href="https://cie.co.at/publications/cie-system-metrology-optical-radiation-iprgc-influenced-responses-light-0">here</a>.</p>
<p>The tabulated action spectra can be downloaded in excel format from
<a class="reference external" href="http:/files.cie.co.at/S026_Table2_Data.xlsx">here</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>binwidth</strong> (<em>int</em>) – Desired width of the wavelength bins in nanometers. The default is <cite>1</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>action_spectra</strong> – CIES026 action spectra for <em>sc</em>, <em>mc</em>, <em>lc</em>, <em>rh</em>, and <em>mel</em>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_CIE_1924_photopic_vl">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_CIE_1924_photopic_vl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_CIE_1924_photopic_vl" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the CIE1924 photopic luminosity function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>binwidth</strong> (<em>int</em>) – Desired width of the wavelength bins in nanometers. The default is <cite>1</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vl</strong> – The CIE1924 photopic luminosity function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_matrix_10_deg_LMStoXYZ">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_matrix_10_deg_LMStoXYZ</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_matrix_10_deg_LMStoXYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Get LMS to XYZ conversion matrix for 10 degree field size.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_matrix_2_deg_LMStoXYZ">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_matrix_2_deg_LMStoXYZ</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_matrix_2_deg_LMStoXYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Get LMS to XYZ transformation matrix for 2 degree field size.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_CIE170_2_chromaticity_coordinates">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_CIE170_2_chromaticity_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_of_purples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_CIE170_2_chromaticity_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the CIE170_2 chromaticity coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>line_of_purples</strong> (<em>bool</em>) – Whether to connect the line of purples by repeating the first row at
the end. The default is <cite>True</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>xyz</strong> – CIE170_2 chromaticity coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_CIEPO06_optical_density">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_CIEPO06_optical_density</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_CIEPO06_optical_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Optical density of lens and other ocular media.</p>
<p>Function D_ocul for an average 32-yr-old observer (pupil diameter &lt; 3mm)
(Stockman, Sharpe and Fach (1999).</p>
<p>D_ocul can be separated into two components: D_ocul_1 represents portion
affected by aging after age 20, and D_ocul_2 represents portion stable
after age 20. (After Pokorny, Smith and Lutze, 1987).</p>
<p>The optical density of the lens of an average observer between the ages of
20 and 60 yr is determined by D_ocul = D_ocul_1 [1 + 0.02(A-32)] +
D_ocul_2</p>
<p>For an average observer over the age of 60, D_ocul = D_ocul_1
[1.56 + 0.0667(A-60)] + D_ocul_2 where A is the observer’s age.</p>
<p>D_ocul_2 is the Stockman and Sharpe (2000) tabulation of lens density
scaled to represent a 32-yr-old observer (the average age of the Stiles
and Burch observers) with a small pupil (&lt; 3 mm). To estimate the lens
density function for a completely open pupil (&gt; 7 mm), multiply the
tabulated values by 0.86207.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>CIEPO06_optical_density</strong> – Optical density as a function of wavelength.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.estimate_CIEPO06_lens_density">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">estimate_CIEPO06_lens_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.estimate_CIEPO06_lens_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate lens density spectrum for observer using CIEPO06.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>age</strong> (<em>int</em>) – Observer age.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>correct_lomd</strong> – DESCRIPTION.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_CIE_203_2012_lens_density">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_CIE_203_2012_lens_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wls</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_CIE_203_2012_lens_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Lens density function from CIE 203:2012 (used for melanopsin).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>age</strong> (<em>int</em>) – Age of observer.</p></li>
<li><p><strong>wls</strong> (<em>array_like</em>) – Wavelength range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Estimated lens density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_CIEPO06_macula_density">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_CIEPO06_macula_density</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_CIEPO06_macula_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Optical density D_macula of the macular pigment.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Series</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.CIE.get_CIE_A_lms">
<span class="sig-prename descclassname"><span class="pre">pysilsub.CIE.</span></span><span class="sig-name descname"><span class="pre">get_CIE_A_lms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.CIE.get_CIE_A_lms" title="Permalink to this definition">¶</a></dt>
<dd><p>Photopigment relative quantal absorbance spectra in log units.</p>
<p>Photopigment optical density curves calculated from the 2° (or 10°) cone
spectral sensitivities of Stockman and Sharpe (2000) at 0.1, 1 or 5 nm
steps. The 0.1 and 1 nm functions were obtained by the interpolation of
the 5 nm functions using a cubic spline. The functions are normalized to
peak at unity at the nearest 0.1 nm step.  In making these calculations, a
macular pigment density of 0.35 at peak, a lens density of 1.76 at 400 nm,
and peak photopigment optical densities of 0.50 (for L and M) and 0.40
(for S) were assumed.  The lens and macular pigment density spectra were
those of Stockman, Sharpe and Fach (1999).</p>
<p>Stockman, A., Sharpe, L. T., &amp; Fach, C. C. (1999). The spectral sensitivity
of the human short-wavelength cones. Vision Research, 39, 2901-2927.</p>
<p>Stockman, A., &amp; Sharpe, L. T. (2000). Spectral sensitivities of the middle-
and long-wavelength sensitive cones derived from measurements in observers
of known genotype. Vision Research, 40, 1711-1737.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

</section>
<span class="target" id="module-pysilsub.precep"></span><section id="pysilsub-precep">
<h2><code class="docutils literal notranslate"><span class="pre">pysilsub.precep</span></code><a class="headerlink" href="#pysilsub-precep" title="Permalink to this heading">¶</a></h2>
<p>Convenience functions for accessing prereceptoral filter functions.</p>
<p>Obtained from <a class="reference external" href="http://www.cvrl.org/">http://www.cvrl.org/</a></p>
<p>&#64;author: jtm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.precep.get_hemoglobin_absorptances">
<span class="sig-prename descclassname"><span class="pre">pysilsub.precep.</span></span><span class="sig-name descname"><span class="pre">get_hemoglobin_absorptances</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.precep.get_hemoglobin_absorptances" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain Prahl’s estimates of hemoglobin absorptance spectra.</p>
<p>These are tabulated data included in the software. They are returned as
molar extinction coefficients (cm-1/M). The wavelength
spacing is 250-1000 in 2 nm bins.</p>
<p>T_oxy is the molar extinction of oxyhemoglobin.</p>
<p>T_deoxy is the molar extinction of deoxyhemoglobin.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://omlc.org/spectra/hemoglobin/summary.html">Link to source of tabulated data</a></p>
<p>See <a class="reference external" href="http://omlc.org/spectra/hemoglobin/">here</a> for further information.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Hemoglobin data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.precep.get_retinal_hemoglobin_transmittance">
<span class="sig-prename descclassname"><span class="pre">pysilsub.precep.</span></span><span class="sig-name descname"><span class="pre">get_retinal_hemoglobin_transmittance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[380,</span> <span class="pre">781,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vessel_oxygenation_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vessel_overall_thickness_um</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.precep.get_retinal_hemoglobin_transmittance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the hemoglobin transmittance spectrum for retinal vasculature.</p>
<p>Return the hemoglobin transmittance spectrum, given a fraction of
oxy/deoxy hemoglobin and an overall thickness of the blood layer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>64500 is the gram molecular weight of hemoglobin.</p>
<p>150 is the grams of Hgb per litre of whole blood.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelengths</strong> (<em>Sequence</em><em>, </em><em>optional</em>) – Start, stop, step of desired wavelengths. The default is [380, 781, 1].</p></li>
<li><p><strong>vessel_oxygenation_fraction</strong> (<em>float</em><em>, </em><em>optional</em>) – Estimate of the fraction of oxygenated blood in vessels. The default
is .85.</p></li>
<li><p><strong>vessel_overall_thickness</strong> (<em>int</em><em>, </em><em>optional</em>) – Estimate of the overal thickness of vessels in uM. The default is 5.</p></li>
<li><p><strong>vessel_overall_thickness_um</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hgb_transmittance</strong> – Hemoglobin transmittance spectra (oxy/deoxy).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.precep.get_melanin_transmittance">
<span class="sig-prename descclassname"><span class="pre">pysilsub.precep.</span></span><span class="sig-name descname"><span class="pre">get_melanin_transmittance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[380,</span> <span class="pre">781,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.precep.get_melanin_transmittance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return melanin transmittance spectrum.</p>
<p>The skin melanin absorption coefficient can be described by the following
formula (eq. 2 in Bierman, Figuiero &amp; Rea, 2011; and
<a class="reference external" href="http://omlc.org/spectra/melanin/mua.html">http://omlc.org/spectra/melanin/mua.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wavelengths</strong> (<em>Sequence</em><em>, </em><em>optional</em>) – Start, stop, step of desired wavelengths. The default is [380, 781, 1].</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This code was translated from the Silent Substution Toolbox for MATLAB.
See <a class="reference external" href="https://github.com/spitschan/SilentSubstitutionToolbox/blob/master/HumanEyelidTransmittance/HumanEyelidTransmittanceBierman.m">here</a>
for more information.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>melanin_transmittance</strong> – Melanin transmittance spectrum.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.precep.get_bilirubin_absorption">
<span class="sig-prename descclassname"><span class="pre">pysilsub.precep.</span></span><span class="sig-name descname"><span class="pre">get_bilirubin_absorption</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.precep.get_bilirubin_absorption" title="Permalink to this definition">¶</a></dt>
<dd><p>Return optical absorption spectrum of Bilirubin in chloroform.</p>
<p>Units are Molar Extinction (cm-1/M)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These tabulated data are from the Silent Substution Toolbox for MATLAB.
See <a class="reference external" href="https://github.com/spitschan/SilentSubstitutionToolbox/blob/master/HumanEyelidTransmittance/xSrc/Prahl2012_BilurubinAbsorptionSpectrum.txt">here</a>
for more information.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Bilirubin absorption spectrum.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.precep.get_bilirubin_transmittance">
<span class="sig-prename descclassname"><span class="pre">pysilsub.precep.</span></span><span class="sig-name descname"><span class="pre">get_bilirubin_transmittance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[380,</span> <span class="pre">781,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.precep.get_bilirubin_transmittance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return bilirubin transmittance spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wavelengths</strong> (<em>Sequence</em><em>, </em><em>optional</em>) – Start, stop, step of desired wavelengths. The default is [380, 781, 1].</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function was translated from the Silent Substution Toolbox for MATLAB.
See <a class="reference external" href="https://github.com/spitschan/SilentSubstitutionToolbox/blob/master/HumanEyelidTransmittance/HumanEyelidTransmittanceBierman.m#L77">here</a>
for more information.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bilirubin_transmittance</strong> – Bilirubin transmittance spectrum.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.precep.get_eyelid_hemoglobin_transmittance">
<span class="sig-prename descclassname"><span class="pre">pysilsub.precep.</span></span><span class="sig-name descname"><span class="pre">get_eyelid_hemoglobin_transmittance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[380,</span> <span class="pre">781,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.precep.get_eyelid_hemoglobin_transmittance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the hemoglobin transmittance spectrum for eyelid vasculature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wavelengths</strong> (<em>Sequence</em><em>, </em><em>optional</em>) – Start, stop, step of desired wavelengths. The default is [380, 781, 1].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hgb_transmittance</strong> – Human eyelid Hgb transmittance spectra (oxy/deoxy).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.precep.get_eyelid_transmittance">
<span class="sig-prename descclassname"><span class="pre">pysilsub.precep.</span></span><span class="sig-name descname"><span class="pre">get_eyelid_transmittance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[380,</span> <span class="pre">781,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.precep.get_eyelid_transmittance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return transmittance spectrum of human eyelid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wavelengths</strong> (<em>Sequence</em><em>, </em><em>optional</em>) – Start, stop, step of desired wavelengths. The default is [380, 781, 1].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eyelid_transmittance</strong> – Transmittance spectrum of human eyelid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.precep.get_lens_density_spectra">
<span class="sig-prename descclassname"><span class="pre">pysilsub.precep.</span></span><span class="sig-name descname"><span class="pre">get_lens_density_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim_visible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.precep.get_lens_density_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Get lens density spectra.</p>
<p>See the following refs for further information:</p>
<dl class="simple">
<dt>Stiles, W. S., &amp; Burch, J. M. (1959). NPL colour-matching investigation:</dt><dd><p>Final report (1958). Optica Acta, 6, 1-26.</p>
</dd>
<dt>Stockman, A., Sharpe, L. T., &amp; Fach, C. C. (1999). The spectral sensitivity</dt><dd><p>of the human short-wavelength cones. Vision Research, 39, 2901-2927.</p>
</dd>
<dt>Stockman, A., &amp; Sharpe, L. T. (2000). Spectral sensitivities of the middle-</dt><dd><p>and long-wavelength sensitive cones derived from measurements in
observers of known genotype. Vision Research, 40, 1711-1737.</p>
</dd>
<dt>van Norren, D. &amp; Vos J.J. (1974) Spectral transmission of the human ocular</dt><dd><p>media Vision Research, 14, 1237-1244.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asdf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the results as a pandas DataFrame. The default is
True.</p></li>
<li><p><strong>binwidth</strong> (<em>int</em><em>, </em><em>optional</em>) – Width of the wavelength bins in nanometers (must be <cite>1</cite> or <cite>5</cite>). The
default is <cite>1</cite>.</p></li>
<li><p><strong>trim_visible</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to trim the CMFs to 380-780 nm. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>density</strong> – Lens optical density as a function of wavelength.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray or pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysilsub.precep.get_macula_pigment_density_spectra">
<span class="sig-prename descclassname"><span class="pre">pysilsub.precep.</span></span><span class="sig-name descname"><span class="pre">get_macula_pigment_density_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim_visible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysilsub.precep.get_macula_pigment_density_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Get macula pigment density spectra.</p>
<p>See the following refs for further information:</p>
<dl class="simple">
<dt>Bone, R. A., Landrum, J. T., &amp; Cains, A. (1992). Optical density spectra of</dt><dd><p>the macular pigment in vivo and in vitro. Vision Research, 32, 105-110.</p>
</dd>
<dt>Stockman, A., Sharpe, L. T., &amp; Fach, C. C. (1999). The spectral sensitivity</dt><dd><p>of the human short-wavelength cones. Vision Research, 39, 2901-2927.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asdf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the results as a pandas DataFrame. The default is
False.</p></li>
<li><p><strong>binwidth</strong> (<em>int</em><em>, </em><em>optional</em>) – Width of the wavelength bins in nanometers (must be <cite>1</cite> or <cite>5</cite>). The
default is <cite>1</cite>.</p></li>
<li><p><strong>trim_visible</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to trim the CMFs to 380-780 nm. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>density</strong> – Macula pigment optical density as a function of wavelength.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray or pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<p class="rubric">Tables and indices</p>
<hr class="docutils" />
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/photoreceptor_characters.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="index.html">PySilSub</a></h1>



<p class="blurb">A Python software for performing the method of silent substitution.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=PySilentSubstitution&repo=pysilsub&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01_background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pysilsub-observers"><code class="docutils literal notranslate"><span class="pre">pysilsub.observers</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pysilsub-devices"><code class="docutils literal notranslate"><span class="pre">pysilsub.devices</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pysilsub-problems"><code class="docutils literal notranslate"><span class="pre">pysilsub.problems</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pysilsub-colorfuncs"><code class="docutils literal notranslate"><span class="pre">pysilsub.colorfuncs</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pysilsub-cie"><code class="docutils literal notranslate"><span class="pre">pysilsub.CIE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pysilsub-precep"><code class="docutils literal notranslate"><span class="pre">pysilsub.precep</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="07_project_notes.html">Project notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_funding.html">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_citation.html">Citation</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://pypi.org/project/pysilsub/">PyPi</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="05d_penumbral_cones.html" title="previous chapter">Cones in the shadow of retinal blood vessels</a></li>
      <li>Next: <a href="07_project_notes.html" title="next chapter">Project notes</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Joel T. Martin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/06_api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>