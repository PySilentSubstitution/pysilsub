#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Fri Aug  5 12:03:54 2022

@author: jtm545
"""

import numpy as np
import pandas as pd
from scipy.interpolate import interp1d


class EasyJAZ:

    # Pixel wavelengths reported by the JAZ.
    wls = np.array([
        340.563915,  340.9440328,  341.3241118,  341.7041521,  342.0841536,
        342.4641162,  342.8440401,  343.2239251,  343.6037713,  343.9835787,
        344.3633472,  344.7430768,  345.1227676,  345.5024196,  345.8820326,
        346.2616068,  346.641142,  347.0206384,  347.4000958,  347.7795143,
        348.1588939,  348.5382345,  348.9175362,  349.2967989,  349.6760226,
        350.0552074,  350.4343532,  350.81346,  351.1925278,  351.5715565,
        351.9505463,  352.329497,  352.7084086,  353.0872813,  353.4661148,
        353.8449093,  354.2236647,  354.6023811,  354.9810583,  355.3596964,
        355.7382954,  356.1168553,  356.4953761,  356.8738578,  357.2523002,
        357.6307036,  358.0090677,  358.3873927,  358.7656785,  359.1439252,
        359.5221326,  359.9003008,  360.2784298,  360.6565195,  361.0345701,
        361.4125813,  361.7905534,  362.1684861,  362.5463796,  362.9242339,
        363.3020488,  363.6798244,  364.0575607,  364.4352577,  364.8129154,
        365.1905338,  365.5681128,  365.9456524,  366.3231527,  366.7006136,
        367.0780352,  367.4554174,  367.8327601,  368.2100635,  368.5873274,
        368.964552,  369.3417371,  369.7188827,  370.0959889,  370.4730557,
        370.850083,  371.2270708,  371.6040191,  371.9809279,  372.3577973,
        372.7346271,  373.1114174,  373.4881682,  373.8648794,  374.2415511,
        374.6181832,  374.9947758,  375.3713288,  375.7478422,  376.124316,
        376.5007503,  376.8771449,  377.2534999,  377.6298153,  378.006091,
        378.3823271,  378.7585235,  379.1346803,  379.5107974,  379.8868749,
        380.2629126,  380.6389107,  381.014869,  381.3907876,  381.7666665,
        382.1425057,  382.5183052,  382.8940648,  383.2697848,  383.6454649,
        384.0211053,  384.3967059,  384.7722667,  385.1477877,  385.5232689,
        385.8987102,  386.2741118,  386.6494735,  387.0247953,  387.4000773,
        387.7753194,  388.1505217,  388.5256841,  388.9008065,  389.2758891,
        389.6509318,  390.0259345,  390.4008974,  390.7758202,  391.1507032,
        391.5255462,  391.9003492,  392.2751122,  392.6498353,  393.0245184,
        393.3991615,  393.7737646,  394.1483276,  394.5228507,  394.8973337,
        395.2717766,  395.6461795,  396.0205424,  396.3948652,  396.7691479,
        397.1433905,  397.517593,  397.8917554,  398.2658777,  398.6399599,
        399.014002,  399.3880039,  399.7619656,  400.1358872,  400.5097687,
        400.8836099,  401.257411,  401.6311719,  402.0048926,  402.378573,
        402.7522133,  403.1258133,  403.4993731,  403.8728926,  404.2463719,
        404.6198109,  404.9932097,  405.3665681,  405.7398863,  406.1131642,
        406.4864018,  406.859599,  407.2327559,  407.6058725,  407.9789488,
        408.3519846,  408.7249802,  409.0979353,  409.4708501,  409.8437245,
        410.2165585,  410.5893521,  410.9621053,  411.334818,  411.7074903,
        412.0801222,  412.4527136,  412.8252646,  413.1977751,  413.5702451,
        413.9426746,  414.3150637,  414.6874122,  415.0597202,  415.4319877,
        415.8042147,  416.1764012,  416.548547,  416.9206524,  417.2927171,
        417.6647413,  418.0367249,  418.408668,  418.7805704,  419.1524322,
        419.5242534,  419.8960339,  420.2677738,  420.6394731,  421.0111317,
        421.3827497,  421.754327,  422.1258636,  422.4973595,  422.8688147,
        423.2402292,  423.611603,  423.9829361,  424.3542284,  424.72548,
        425.0966909,  425.467861,  425.8389903,  426.2100788,  426.5811266,
        426.9521335,  427.3230996,  427.694025,  428.0649095,  428.4357532,
        428.806556,  429.177318,  429.5480391,  429.9187194,  430.2893588,
        430.6599573,  431.0305149,  431.4010316,  431.7715074,  432.1419423,
        432.5123362,  432.8826892,  433.2530013,  433.6232724,  433.9935025,
        434.3636917,  434.7338399,  435.1039471,  435.4740133,  435.8440385,
        436.2140227,  436.5839658,  436.9538679,  437.323729,  437.693549,
        438.0633279,  438.4330658,  438.8027626,  439.1724183,  439.5420329,
        439.9116065,  440.2811388,  440.6506301,  441.0200803,  441.3894892,
        441.7588571,  442.1281838,  442.4974693,  442.8667136,  443.2359168,
        443.6050787,  443.9741995,  444.343279,  444.7123174,  445.0813144,
        445.4502703,  445.8191849,  446.1880582,  446.5568903,  446.9256811,
        447.2944307,  447.6631389,  448.0318058,  448.4004314,  448.7690157,
        449.1375587,  449.5060603,  449.8745206,  450.2429396,  450.6113171,
        450.9796533,  451.3479481,  451.7162016,  452.0844136,  452.4525842,
        452.8207134,  453.1888012,  453.5568476,  453.9248525,  454.2928159,
        454.6607379,  455.0286184,  455.3964575,  455.764255,  456.1320111,
        456.4997256,  456.8673987,  457.2350302,  457.6026202,  457.9701686,
        458.3376755,  458.7051408,  459.0725646,  459.4399468,  459.8072874,
        460.1745864,  460.5418438,  460.9090596,  461.2762338,  461.6433664,
        462.0104573,  462.3775066,  462.7445142,  463.1114801,  463.4784044,
        463.845287,  464.2121279,  464.5789271,  464.9456846,  465.3124003,
        465.6790744,  466.0457067,  466.4122972,  466.7788461,  467.1453531,
        467.5118184,  467.8782419,  468.2446236,  468.6109635,  468.9772616,
        469.3435179,  469.7097324,  470.075905,  470.4420358,  470.8081247,
        471.1741718,  471.540177,  471.9061403,  472.2720618,  472.6379413,
        473.003779,  473.3695747,  473.7353285,  474.1010404,  474.4667104,
        474.8323384,  475.1979244,  475.5634685,  475.9289706,  476.2944307,
        476.6598488,  477.0252249,  477.390559,  477.7558511,  478.1211012,
        478.4863092,  478.8514752,  479.2165991,  479.581681,  479.9467208,
        480.3117185,  480.6766741,  481.0415876,  481.406459,  481.7712883,
        482.1360755,  482.5008205,  482.8655234,  483.2301841,  483.5948027,
        483.9593791,  484.3239133,  484.6884054,  485.0528552,  485.4172628,
        485.7816283,  486.1459515,  486.5102324,  486.8744712,  487.2386676,
        487.6028219,  487.9669338,  488.3310035,  488.6950309,  489.059016,
        489.4229588,  489.7868592,  490.1507174,  490.5145332,  490.8783067,
        491.2420379,  491.6057267,  491.9693731,  492.3329771,  492.6965388,
        493.0600581,  493.423535,  493.7869694,  494.1503615,  494.5137111,
        494.8770183,  495.240283,  495.6035053,  495.9666851,  496.3298225,
        496.6929173,  497.0559697,  497.4189796,  497.781947,  498.1448719,
        498.5077542,  498.870594,  499.2333913,  499.596146,  499.9588581,
        500.3215277,  500.6841547,  501.0467391,  501.409281,  501.7717802,
        502.1342368,  502.4966508,  502.8590221,  503.2213508,  503.5836369,
        503.9458803,  504.308081,  504.6702391,  505.0323545,  505.3944272,
        505.7564572,  506.1184444,  506.480389,  506.8422908,  507.2041499,
        507.5659663,  507.9277399,  508.2894707,  508.6511587,  509.012804,
        509.3744065,  509.7359662,  510.097483,  510.4589571,  510.8203883,
        511.1817767,  511.5431223,  511.904425,  512.2656848,  512.6269018,
        512.9880759,  513.3492071,  513.7102954,  514.0713408,  514.4323433,
        514.7933028,  515.1542194,  515.5150931,  515.8759239,  516.2367116,
        516.5974565,  516.9581583,  517.3188171,  517.679433,  518.0400058,
        518.4005357,  518.7610225,  519.1214663,  519.481867,  519.8422247,
        520.2025394,  520.562811,  520.9230395,  521.2832249,  521.6433672,
        522.0034664,  522.3635226,  522.7235356,  523.0835054,  523.4434322,
        523.8033158,  524.1631562,  524.5229535,  524.8827076,  525.2424185,
        525.6020863,  525.9617108,  526.3212921,  526.6808302,  527.0403251,
        527.3997768,  527.7591852,  528.1185503,  528.4778723,  528.8371509,
        529.1963862,  529.5555783,  529.9147271,  530.2738325,  530.6328947,
        530.9919135,  531.350889,  531.7098212,  532.06871,  532.4275554,
        532.7863575,  533.1451162,  533.5038316,  533.8625035,  534.221132,
        534.5797172,  534.9382589,  535.2967571,  535.655212,  536.0136233,
        536.3719913,  536.7303157,  537.0885967,  537.4468343,  537.8050283,
        538.1631788,  538.5212858,  538.8793493,  539.2373693,  539.5953457,
        539.9532786,  540.311168,  540.6690137,  541.0268159,  541.3845746,
        541.7422896,  542.099961,  542.4575889,  542.8151731,  543.1727137,
        543.5302107,  543.887664,  544.2450737,  544.6024397,  544.959762,
        545.3170407,  545.6742757,  546.031467,  546.3886145,  546.7457184,
        547.1027786,  547.459795,  547.8167677,  548.1736966,  548.5305818,
        548.8874232,  549.2442208,  549.6009747,  549.9576847,  550.314351,
        550.6709735,  551.0275521,  551.3840869,  551.7405779,  552.097025,
        552.4534283,  552.8097877,  553.1661032,  553.5223749,  553.8786026,
        554.2347865,  554.5909264,  554.9470225,  555.3030746,  555.6590828,
        556.015047,  556.3709673,  556.7268436,  557.082676,  557.4384644,
        557.7942088,  558.1499092,  558.5055655,  558.8611779,  559.2167463,
        559.5722706,  559.9277509,  560.2831871,  560.6385793,  560.9939274,
        561.3492314,  561.7044914,  562.0597072,  562.414879,  562.7700066,
        563.1250902,  563.4801295,  563.8351248,  564.1900759,  564.5449829,
        564.8998457,  565.2546643,  565.6094387,  565.9641689,  566.318855,
        566.6734968,  567.0280944,  567.3826478,  567.737157,  568.0916219,
        568.4460425,  568.8004189,  569.154751,  569.5090389,  569.8632824,
        570.2174817,  570.5716366,  570.9257473,  571.2798136,  571.6338356,
        571.9878132,  572.3417465,  572.6956354,  573.04948,  573.4032802,
        573.757036,  574.1107474,  574.4644144,  574.8180369,  575.1716151,
        575.5251488,  575.8786381,  576.232083,  576.5854834,  576.9388393,
        577.2921507,  577.6454177,  577.9986402,  578.3518181,  578.7049516,
        579.0580405,  579.4110849,  579.7640848,  580.1170401,  580.4699509,
        580.8228171,  581.1756388,  581.5284158,  581.8811483,  582.2338362,
        582.5864794,  582.9390781,  583.2916321,  583.6441415,  583.9966062,
        584.3490263,  584.7014018,  585.0537325,  585.4060186,  585.75826,
        586.1104567,  586.4626087,  586.814716,  587.1667785,  587.5187963,
        587.8707694,  588.2226978,  588.5745813,  588.9264201,  589.2782142,
        589.6299634,  589.9816679,  590.3333275,  590.6849424,  591.0365124,
        591.3880376,  591.7395179,  592.0909534,  592.4423441,  592.7936899,
        593.1449908,  593.4962468,  593.8474579,  594.1986242,  594.5497455,
        594.9008219,  595.2518534,  595.6028399,  595.9537815,  596.3046782,
        596.6555299,  597.0063366,  597.3570983,  597.7078151,  598.0584868,
        598.4091136,  598.7596953,  599.110232,  599.4607237,  599.8111703,
        600.1615719,  600.5119284,  600.8622398,  601.2125062,  601.5627275,
        601.9129037,  602.2630348,  602.6131207,  602.9631616,  603.3131573,
        603.6631079,  604.0130133,  604.3628736,  604.7126887,  605.0624586,
        605.4121834,  605.7618629,  606.1114973,  606.4610864,  606.8106303,
        607.160129,  607.5095825,  607.8589907,  608.2083537,  608.5576714,
        608.9069438,  609.2561709,  609.6053528,  609.9544893,  610.3035806,
        610.6526265,  611.0016271,  611.3505824,  611.6994923,  612.0483569,
        612.3971761,  612.7459499,  613.0946784,  613.4433615,  613.7919991,
        614.1405914,  614.4891383,  614.8376397,  615.1860957,  615.5345063,
        615.8828714,  616.231191,  616.5794652,  616.9276939,  617.2758771,
        617.6240149,  617.9721071,  618.3201538,  618.668155,  619.0161107,
        619.3640208,  619.7118854,  620.0597044,  620.4074778,  620.7552057,
        621.102888,  621.4505247,  621.7981158,  622.1456613,  622.4931612,
        622.8406155,  623.1880241,  623.5353871,  623.8827044,  624.229976,
        624.577202,  624.9243823,  625.2715169,  625.6186059,  625.9656491,
        626.3126466,  626.6595983,  627.0065044,  627.3533647,  627.7001792,
        628.046948,  628.393671,  628.7403483,  629.0869797,  629.4335654,
        629.7801052,  630.1265992,  630.4730475,  630.8194498,  631.1658064,
        631.5121171,  631.8583819,  632.2046009,  632.550774,  632.8969012,
        633.2429825,  633.5890179,  633.9350074,  634.280951,  634.6268487,
        634.9727004,  635.3185062,  635.664266,  636.0099799,  636.3556477,
        636.7012696,  637.0468455,  637.3923755,  637.7378594,  638.0832972,
        638.4286891,  638.7740349,  639.1193347,  639.4645884,  639.8097961,
        640.1549577,  640.5000732,  640.8451426,  641.190166,  641.5351432,
        641.8800743,  642.2249593,  642.5697982,  642.9145909,  643.2593374,
        643.6040378,  643.9486921,  644.2933001,  644.637862,  644.9823777,
        645.3268472,  645.6712704,  646.0156475,  646.3599783,  646.7042629,
        647.0485012,  647.3926933,  647.7368391,  648.0809386,  648.4249919,
        648.7689988,  649.1129595,  649.4568738,  649.8007419,  650.1445636,
        650.4883389,  650.832068,  651.1757506,  651.5193869,  651.8629769,
        652.2065204,  652.5500176,  652.8934683,  653.2368727,  653.5802306,
        653.9235421,  654.2668072,  654.6100259,  654.953198,  655.2963238,
        655.639403,  655.9824358,  656.3254221,  656.6683619,  657.0112552,
        657.354102,  657.6969022,  658.039656,  658.3823631,  658.7250238,
        659.0676379,  659.4102054,  659.7527263,  660.0952007,  660.4376284,
        660.7800096,  661.1223441,  661.464632,  661.8068733,  662.149068,
        662.491216,  662.8333174,  663.175372,  663.5173801,  663.8593414,
        664.2012561,  664.543124,  664.8849452,  665.2267198,  665.5684476,
        665.9101286,  666.2517629,  666.5933505,  666.9348913,  667.2763853,
        667.6178326,  667.959233,  668.3005867,  668.6418936,  668.9831536,
        669.3243668,  669.6655332,  670.0066528,  670.3477254,  670.6887513,
        671.0297303,  671.3706623,  671.7115475,  672.0523859,  672.3931773,
        672.7339218,  673.0746193,  673.41527,  673.7558737,  674.0964304,
        674.4369402,  674.7774031,  675.1178189,  675.4581878,  675.7985097,
        676.1387846,  676.4790124,  676.8191933,  677.1593271,  677.4994139,
        677.8394537,  678.1794464,  678.519392,  678.8592905,  679.199142,
        679.5389464,  679.8787037,  680.2184139,  680.5580769,  680.8976929,
        681.2372617,  681.5767833,  681.9162578,  682.2556852,  682.5950654,
        682.9343984,  683.2736842,  683.6129228,  683.9521142,  684.2912584,
        684.6303554,  684.9694051,  685.3084076,  685.6473629,  685.9862709,
        686.3251316,  686.663945,  687.0027112,  687.3414301,  687.6801017,
        688.0187259,  688.3573029,  688.6958325,  689.0343147,  689.3727497,
        689.7111372,  690.0494774,  690.3877703,  690.7260157,  691.0642138,
        691.4023644,  691.7404677,  692.0785235,  692.4165319,  692.7544929,
        693.0924064,  693.4302725,  693.7680911,  694.1058623,  694.4435859,
        694.7812621,  695.1188908,  695.4564719,  695.7940056,  696.1314917,
        696.4689303,  696.8063214,  697.1436649,  697.4809608,  697.8182092,
        698.15541,  698.4925632,  698.8296688,  699.1667268,  699.5037372,
        699.8407,  700.1776151,  700.5144827,  700.8513025,  701.1880747,
        701.5247993,  701.8614761,  702.1981053,  702.5346868,  702.8712206,
        703.2077066,  703.544145,  703.8805356,  704.2168785,  704.5531737,
        704.8894211,  705.2256207,  705.5617725,  705.8978766,  706.2339329,
        706.5699414,  706.9059021,  707.2418149,  707.57768,  707.9134972,
        708.2492665,  708.584988,  708.9206617,  709.2562874,  709.5918653,
        709.9273954,  710.2628775,  710.5983117,  710.933698,  711.2690363,
        711.6043268,  711.9395693,  712.2747638,  712.6099104,  712.945009,
        713.2800597,  713.6150623,  713.950017,  714.2849237,  714.6197823,
        714.954593,  715.2893556,  715.6240701,  715.9587366,  716.2933551,
        716.6279255,  716.9624478,  717.2969221,  717.6313482,  717.9657263,
        718.3000562,  718.634338,  718.9685717,  719.3027573,  719.6368947,
        719.970984,  720.3050251,  720.639018,  720.9729627,  721.3068593,
        721.6407076,  721.9745078,  722.3082597,  722.6419635,  722.9756189,
        723.3092262,  723.6427852,  723.9762959,  724.3097583,  724.6431725,
        724.9765384,  725.309856,  725.6431253,  725.9763463,  726.309519,
        726.6426433,  726.9757193,  727.3087469,  727.6417262,  727.9746571,
        728.3075397,  728.6403738,  728.9731596,  729.305897,  729.6385859,
        729.9712265,  730.3038186,  730.6363622,  730.9688575,  731.3013042,
        731.6337025,  731.9660524,  732.2983537,  732.6306066,  732.9628109,
        733.2949668,  733.6270741,  733.9591329,  734.2911432,  734.6231049,
        734.9550181,  735.2868827,  735.6186988,  735.9504663,  736.2821851,
        736.6138554,  736.9454771,  737.2770502,  737.6085746,  737.9400504,
        738.2714776,  738.6028561,  738.934186,  739.2654672,  739.5966997,
        739.9278835,  740.2590187,  740.5901051,  740.9211428,  741.2521318,
        741.5830721,  741.9139636,  742.2448064,  742.5756004,  742.9063457,
        743.2370422,  743.5676899,  743.8982888,  744.2288389,  744.5593402,
        744.8897927,  745.2201964,  745.5505512,  745.8808572,  746.2111143,
        746.5413226,  746.871482,  747.2015925,  747.5316541,  747.8616668,
        748.1916306,  748.5215455,  748.8514115,  749.1812286,  749.5109967,
        749.8407158,  750.170386,  750.5000072,  750.8295795,  751.1591027,
        751.488577,  751.8180022,  752.1473785,  752.4767057,  752.8059839,
        753.135213,  753.4643931,  753.7935242,  754.1226062,  754.4516391,
        754.7806229,  755.1095576,  755.4384432,  755.7672797,  756.0960671,
        756.4248054,  756.7534945,  757.0821345,  757.4107253,  757.739267,
        758.0677595,  758.3962028,  758.7245969,  759.0529418,  759.3812375,
        759.709484,  760.0376813,  760.3658293,  760.6939281,  761.0219776,
        761.3499779,  761.6779289,  762.0058306,  762.333683,  762.6614862,
        762.98924,  763.3169445,  763.6445997,  763.9722056,  764.2997621,
        764.6272692,  764.9547271,  765.2821355,  765.6094946,  765.9368042,
        766.2640645,  766.5912754,  766.9184369,  767.2455489,  767.5726115,
        767.8996247,  768.2265884,  768.5535027,  768.8803675,  769.2071829,
        769.5339487,  769.8606651,  770.1873319,  770.5139493,  770.8405171,
        771.1670354,  771.4935042,  771.8199234,  772.1462931,  772.4726132,
        772.7988837,  773.1251047,  773.451276,  773.7773978,  774.1034699,
        774.4294925,  774.7554654,  775.0813887,  775.4072623,  775.7330863,
        776.0588606,  776.3845853,  776.7102603,  777.0358856,  777.3614612,
        777.6869871,  778.0124632,  778.3378897,  778.6632664,  778.9885934,
        779.3138706,  779.6390981,  779.9642758,  780.2894038,  780.6144819,
        780.9395103,  781.2644888,  781.5894176,  781.9142965,  782.2391256,
        782.5639048,  782.8886343,  783.2133138,  783.5379435,  783.8625233,
        784.1870533,  784.5115333,  784.8359634,  785.1603437,  785.484674,
        785.8089544,  786.1331849,  786.4573654,  786.7814959,  787.1055765,
        787.4296072,  787.7535878,  788.0775185,  788.4013991,  788.7252298,
        789.0490104,  789.372741,  789.6964216,  790.0200522,  790.3436327,
        790.6671631,  790.9906435,  791.3140737,  791.637454,  791.9607841,
        792.2840641,  792.607294,  792.9304737,  793.2536034,  793.5766829,
        793.8997122,  794.2226914,  794.5456204,  794.8684993,  795.191328,
        795.5141065,  795.8368347,  796.1595128,  796.4821407,  796.8047183,
        797.1272457,  797.4497228,  797.7721497,  798.0945263,  798.4168527,
        798.7391287,  799.0613545,  799.38353,  799.7056552,  800.02773,
        800.3497546,  800.6717288,  800.9936526,  801.3155261,  801.6373493,
        801.959122,  802.2808444,  802.6025164,  802.924138,  803.2457092,
        803.56723,  803.8887004,  804.2101203,  804.5314898,  804.8528089,
        805.1740775,  805.4952956,  805.8164632,  806.1375804,  806.4586471,
        806.7796632,  807.1006289,  807.421544,  807.7424086,  808.0632227,
        808.3839862,  808.7046992,  809.0253616,  809.3459734,  809.6665347,
        809.9870453,  810.3075054,  810.6279148,  810.9482736,  811.2685818,
        811.5888394,  811.9090463,  812.2292026,  812.5493082,  812.8693631,
        813.1893674,  813.5093209,  813.8292238,  814.149076,  814.4688774,
        814.7886281,  815.1083281,  815.4279774,  815.7475759,  816.0671236,
        816.3866206,  816.7060667,  817.0254621,  817.3448068,  817.6641006,
        817.9833436,  818.3025357,  818.6216771,  818.9407676,  819.2598072,
        819.578796,  819.8977339,  820.216621,  820.5354572,  820.8542424,
        821.1729768,  821.4916603,  821.8102928,  822.1288744,  822.4474051,
        822.7658849,  823.0843136,  823.4026915,  823.7210183,  824.0392942,
        824.357519,  824.6756929,  824.9938158,  825.3118876,  825.6299085,
        825.9478783,  826.265797,  826.5836647,  826.9014813,  827.2192469,
        827.5369614,  827.8546248,  828.1722371,  828.4897983,  828.8073084,
        829.1247673,  829.4421751,  829.7595318,  830.0768374,  830.3940917,
        830.711295,  831.028447,  831.3455478,  831.6625975,  831.979596,
        832.2965432,  832.6134392,  832.930284,  833.2470776,  833.5638199,
        833.8805109,  834.1971507,  834.5137392,  834.8302764,  835.1467624,
        835.463197,  835.7795803,  836.0959123,  836.412193,  836.7284224,
        837.0446004,  837.360727,  837.6768023,  837.9928262,  838.3087988,
        838.6247199,  838.9405897,  839.256408,  839.5721749,  839.8878904,
        840.2035545,  840.5191671,  840.8347283,  841.150238,  841.4656962,
        841.781103,  842.0964583,  842.4117621,  842.7270144,  843.0422151,
        843.3573644,  843.6724621,  843.9875083,  844.3025029,  844.617446,
        844.9323375,  845.2471774,  845.5619657,  845.8767025,  846.1913876,
        846.5060212,  846.8206031,  847.1351334,  847.4496121,  847.7640391,
        848.0784144,  848.3927381,  848.7070101,  849.0212305,  849.3353991,
        849.6495161,  849.9635813,  850.2775948,  850.5915566,  850.9054667,
        851.219325,  851.5331315,  851.8468864,  852.1605894,  852.4742406,
        852.7878401,  853.1013878,  853.4148836,  853.7283277,  854.0417199,
        854.3550603,  854.6683489,  854.9815856,  855.2947704,  855.6079034,
        855.9209845,  856.2340137,  856.546991,  856.8599164,  857.1727899,
        857.4856115,  857.7983812,  858.1110989,  858.4237647,  858.7363785,
        859.0489403,  859.3614502,  859.6739081,  859.986314,  860.2986679,
        860.6109698,  860.9232196,  861.2354175,  861.5475633,  861.859657,
        862.1716988,  862.4836884,  862.795626,  863.1075115,  863.4193449,
        863.7311262,  864.0428554,  864.3545324,  864.6661574,  864.9777302,
        865.2892509,  865.6007194,  865.9121358,  866.2235,  866.534812,
        866.8460719,  867.1572795,  867.468435,  867.7795382,  868.0905892,
        868.4015879,  868.7125345,  869.0234288,  869.3342708,  869.6450605,
        869.955798,  870.2664832,  870.5771161,  870.8876967,  871.198225,
        871.508701,  871.8191246,  872.1294959,  872.4398149,  872.7500815,
        873.0602957,  873.3704576,  873.6805671,  873.9906242,  874.3006289,
        874.6105811,  874.920481,  875.2303285,  875.5401235,  875.849866,
        876.1595561,  876.4691938,  876.778779,  877.0883117,  877.3977919,
        877.7072196,  878.0165948,  878.3259175,  878.6351877,  878.9444053,
        879.2535704,  879.5626829,  879.8717429,  880.1807503,  880.4897052,
        880.7986074,  881.1074571,  881.4162542,  881.7249986,  882.0336904,
        882.3423296,  882.6509162,  882.9594501,  883.2679313,  883.5763599,
        883.8847358,  884.1930591,  884.5013296,  884.8095474,  885.1177126,
        885.425825,  885.7338846,  886.0418916,  886.3498458,  886.6577472,
        886.9655959,  887.2733918,  887.5811349,  887.8888253,  888.1964628,
        888.5040476,  888.8115795,  889.1190586,  889.4264848,  889.7338582,
        890.0411788,  890.3484465,  890.6556613,  890.9628233,  891.2699324,
        891.5769885,  891.8839918,  892.1909422,  892.4978396,  892.8046841,
        893.1114756,  893.4182143,  893.7248999,  894.0315326,  894.3381123,
        894.644639,  894.9511128,  895.2575335,  895.5639012,  895.8702159,
        896.1764776,  896.4826862,  896.7888418,  897.0949443,  897.4009938,
        897.7069902,  898.0129335,  898.3188237,  898.6246608,  898.9304448,
        899.2361757,  899.5418535,  899.8474781,  900.1530496,  900.4585679,
        900.7640331,  901.0694451,  901.3748039,  901.6801096,  901.985362,
        902.2905612,  902.5957072,  902.9008,  903.2058396,  903.5108259,
        903.815759,  904.1206388,  904.4254653,  904.7302386,  905.0349585,
        905.3396252,  905.6442386,  905.9487987,  906.2533054,  906.5577588,
        906.8621589,  907.1665056,  907.470799,  907.775039,  908.0792256,
        908.3833589,  908.6874387,  908.9914652,  909.2954382,  909.5993578,
        909.903224,  910.2070368,  910.5107961,  910.8145019,  911.1181543,
        911.4217532,  911.7252987,  912.0287906,  912.3322291,  912.635614,
        912.9389455,  913.2422234,  913.5454477,  913.8486186,  914.1517358,
        914.4547995,  914.7578097,  915.0607662,  915.3636692,  915.6665186,
        915.9693144,  916.2720565,  916.5747451,  916.87738,  917.1799613,
        917.4824889,  917.7849628,  918.0873831,  918.3897497,  918.6920627,
        918.9943219,  919.2965274,  919.5986793,  919.9007774,  920.2028217,
        920.5048124,  920.8067493,  921.1086324,  921.4104618,  921.7122373,
        922.0139592,  922.3156272,  922.6172414,  922.9188018,  923.2203084,
        923.5217612,  923.8231601,  924.1245052,  924.4257964,  924.7270338,
        925.0282173,  925.3293469,  925.6304226,  925.9314445,  926.2324124,
        926.5333264,  926.8341865,  927.1349927,  927.4357449,  927.7364431,
        928.0370874,  928.3376778,  928.6382141,  928.9386965,  929.2391249,
        929.5394992,  929.8398196,  930.1400859,  930.4402982,  930.7404565,
        931.0405607,  931.3406109,  931.640607,  931.940549,  932.2404369,
        932.5402708,  932.8400505,  933.1397761,  933.4394477,  933.739065,
        934.0386283,  934.3381374,  934.6375923,  934.9369931,  935.2363397,
        935.5356322,  935.8348704,  936.1340544,  936.4331843,  936.7322599,
        937.0312813,  937.3302484,  937.6291613,  937.92802,  938.2268244,
        938.5255745,  938.8242704,  939.1229119,  939.4214992,  939.7200322,
        940.0185108,  940.3169351,  940.6153051,  940.9136208,  941.2118821,
        941.510089,  941.8082416,  942.1063398,  942.4043836,  942.702373,
        943.000308,  943.2981886,  943.5960148,  943.8937866,  944.1915039,
        944.4891668,  944.7867752,  945.0843291,  945.3818286,  945.6792736,
        945.9766641,  946.2740001,  946.5712816,  946.8685085,  947.165681,
        947.4627989,  947.7598623,  948.0568711,  948.3538253,  948.650725,
        948.9475701,  949.2443606,  949.5410965,  949.8377778,  950.1344045,
        950.4309766,  950.727494,  951.0239568,  951.3203649,  951.6167184,
        951.9130172,  952.2092613,  952.5054508,  952.8015855,  953.0976656,
        953.3936909,  953.6896615,  953.9855774,  954.2814385,  954.5772449,
        954.8729965,  955.1686934,  955.4643355,  955.7599228,  956.0554553,
        956.350933,  956.6463559,  956.941724,  957.2370372,  957.5322956,
        957.8274992,  958.1226479,  958.4177418,  958.7127808,  959.0077648,
        959.3026941,  959.5975684,  959.8923878,  960.1871522,  960.4818618,
        960.7765164,  961.0711161,  961.3656608,  961.6601506,  961.9545854,
        962.2489652,  962.54329,  962.8375598,  963.1317746,  963.4259345,
        963.7200392,  964.014089,  964.3080837,  964.6020234,  964.895908,
        965.1897375,  965.483512,  965.7772313,  966.0708956,  966.3645048,
        966.6580588,  966.9515578,  967.2450016,  967.5383903,  967.8317238,
        968.1250022,  968.4182254,  968.7113934,  969.0045062,  969.2975639,
        969.5905663,  969.8835136,  970.1764056,  970.4692424,  970.762024,
        971.0547503,  971.3474214,  971.6400372,  971.9325977,  972.2251029,
        972.5175529,  972.8099476,  973.1022869,  973.394571,  973.6867997,
        973.978973,  974.2710911,  974.5631538,  974.8551611,  975.1471131,
        975.4390096,  975.7308508,  976.0226366,  976.314367,  976.606042,
        976.8976615,  977.1892257,  977.4807343,  977.7721876,  978.0635854,
        978.3549277,  978.6462145,  978.9374459,  979.2286217,  979.5197421,
        979.8108069,  980.1018162,  980.39277,  980.6836683,  980.974511,
        981.2652982,  981.5560298,  981.8467058,  982.1373262,  982.4278911,
        982.7184003,  983.0088539,  983.299252,  983.5895944,  983.8798811,
        984.1701122,  984.4602877,  984.7504075,  985.0404716,  985.3304801,
        985.6204329,  985.9103299,  986.2001713,  986.4899569,  986.7796869,
        987.069361,  987.3589795,  987.6485422,  987.9380491,  988.2275003,
        988.5168957,  988.8062353,  989.0955191,  989.3847471,  989.6739193,
        989.9630357,  990.2520962,  990.5411009,  990.8300498,  991.1189428,
        991.4077799,  991.6965612,  991.9852866,  992.2739561,  992.5625697,
        992.8511273,  993.1396291,  993.4280749,  993.7164648,  994.0047988,
        994.2930768,  994.5812988,  994.8694649,  995.1575749,  995.445629,
        995.7336271,  996.0215692,  996.3094553,  996.5972853,  996.8850593,
        997.1727773,  997.4604392,  997.748045,  998.0355948,  998.3230885,
        998.6105261,  998.8979077,  999.1852331,  999.4725024,  999.7597156,
        1000.046873, 1000.333974, 1000.621018, 1000.908007, 1001.194939,
        1001.481816, 1001.768636, 1002.0554, 1002.342107, 1002.628759,
        1002.915354, 1003.201893, 1003.488376, 1003.774802, 1004.061173,
        1004.347487, 1004.633744, 1004.919946, 1005.206091, 1005.49218,
        1005.778212, 1006.064189, 1006.350108, 1006.635972, 1006.921779,
        1007.20753, 1007.493225, 1007.778863, 1008.064445, 1008.34997,
        1008.635439, 1008.920852, 1009.206208, 1009.491507, 1009.776751,
        1010.061938, 1010.347068, 1010.632142, 1010.917159, 1011.20212,
        1011.487025, 1011.771873, 1012.056665, 1012.3414, 1012.626078,
        1012.9107, 1013.195265, 1013.479774, 1013.764227, 1014.048622,
        1014.332962, 1014.617244, 1014.90147, 1015.18564, 1015.469752,
        1015.753808, 1016.037808, 1016.321751, 1016.605637, 1016.889467,
        1017.17324, 1017.456956, 1017.740616, 1018.024218, 1018.307765,
        1018.591254, 1018.874687, 1019.158063, 1019.441382, 1019.724645,
        1020.007851, 1020.291, 1020.574092, 1020.857127, 1021.140106,
        1021.423028, 1021.705893, 1021.988702, 1022.271453, 1022.554148,
        1022.836786, 1023.119366, 1023.401891, 1023.684358, 1023.966768,
        1024.249122, 1024.531418, 1024.813658])

    # Wavelengths calibrated against spectral lines of an argon lamp
    cal_wls = np.array([
        340.89458721,  341.27197938,  341.64933892,  342.02666579,  342.40396,
        342.78122151,  343.15845033,  343.53564643,  343.91280981,  344.28994043,
        344.66703831,  345.0441034,  345.42113571,  345.79813522,  346.17510192,
        346.55203578,  346.9289368,  347.30580496,  347.68264025,  348.05944265,
        348.43621215,  348.81294873,  349.18965238,  349.56632309,  349.94296083,
        350.31956561,  350.69613739,  351.07267617,  351.44918194,  351.82565467,
        352.20209436,  352.57850099,  352.95487455,  353.33121501,  353.70752238,
        354.08379662,  354.46003774,  354.8362457,  355.21242051,  355.58856214,
        355.96467058,  356.34074582,  356.71678785,  357.09279663,  357.46877218,
        357.84471446,  358.22062346,  358.59649918,  358.97234159,  359.34815068,
        359.72392644,  360.09966886,  360.47537791,  360.85105358,  361.22669587,
        361.60230475,  361.97788021,  362.35342224,  362.72893081,  363.10440593,
        363.47984757,  363.85525572,  364.23063037,  364.60597149,  364.98127908,
        365.35655312,  365.7317936,  366.1070005,  366.48217381,  366.85731352,
        367.2324196,  367.60749205,  367.98253085,  368.35753599,  368.73250745,
        369.10744521,  369.48234927,  369.85721961,  370.23205622,  370.60685907,
        370.98162816,  371.35636348,  371.731065,  372.10573271,  372.4803666,
        372.85496665,  373.22953286,  373.6040652,  373.97856366,  374.35302823,
        374.72745889,  375.10185563,  375.47621843,  375.85054728,  376.22484217,
        376.59910308,  376.97332999,  377.34752289,  377.72168178,  378.09580662,
        378.46989741,  378.84395414,  379.21797679,  379.59196534,  379.96591979,
        380.33984011,  380.71372629,  381.08757833,  381.46139619,  381.83517988,
        382.20892937,  382.58264465,  382.9563257,  383.32997252,  383.70358509,
        384.07716339,  384.45070741,  384.82421713,  385.19769254,  385.57113363,
        385.94454038,  386.31791277,  386.6912508,  387.06455445,  387.4378237,
        387.81105854,  388.18425896,  388.55742493,  388.93055646,  389.30365351,
        389.67671608,  390.04974416,  390.42273772,  390.79569676,  391.16862126,
        391.5415112,  391.91436658,  392.28718737,  392.65997357,  393.03272515,
        393.40544211,  393.77812443,  394.15077209,  394.52338508,  394.89596339,
        395.268507,  395.6410159,  396.01349008,  396.38592951,  396.75833419,
        397.13070409,  397.50303922,  397.87533954,  398.24760505,  398.61983574,
        398.99203158,  399.36419256,  399.73631868,  400.10840991,  400.48046624,
        400.85248766,  401.22447415,  401.5964257,  401.9683423,  402.34022392,
        402.71207055,  403.08388219,  403.45565881,  403.82740041,  404.19910696,
        404.57077845,  404.94241488,  405.31401621,  405.68558245,  406.05711357,
        406.42860957,  406.80007042,  407.17149611,  407.54288663,  407.91424196,
        408.28556209,  408.65684701,  409.0280967,  409.39931114,  409.77049033,
        410.14163424,  410.51274287,  410.8838162,  411.25485421,  411.62585688,
        411.99682422,  412.36775619,  412.7386528,  413.10951401,  413.48033983,
        413.85113022,  414.22188519,  414.59260471,  414.96328877,  415.33393736,
        415.70455046,  416.07512805,  416.44567013,  416.81617668,  417.18664769,
        417.55708313,  417.927483,  418.29784728,  418.66817596,  419.03846902,
        419.40872644,  419.77894822,  420.14913435,  420.51928479,  420.88939955,
        421.2594786,  421.62952194,  421.99952954,  422.36950139,  422.73943749,
        423.10933781,  423.47920234,  423.84903106,  424.21882397,  424.58858104,
        424.95830227,  425.32798763,  425.69763712,  426.06725071,  426.43682841,
        426.80637018,  427.17587602,  427.54534591,  427.91477984,  428.28417779,
        428.65353976,  429.02286571,  429.39215565,  429.76140955,  430.13062741,
        430.4998092,  430.86895491,  431.23806453,  431.60713805,  431.97617544,
        432.3451767,  432.71414182,  433.08307077,  433.45196354,  433.82082011,
        434.18964049,  434.55842464,  434.92717255,  435.29588422,  435.66455962,
        436.03319874,  436.40180157,  436.7703681,  437.1388983,  437.50739217,
        437.87584968,  438.24427083,  438.6126556,  438.98100398,  439.34931595,
        439.7175915,  440.08583062,  440.45403328,  440.82219947,  441.19032919,
        441.55842241,  441.92647913,  442.29449932,  442.66248298,  443.03043008,
        443.39834062,  443.76621457,  444.13405194,  444.50185269,  444.86961682,
        445.23734432,  445.60503516,  445.97268933,  446.34030683,  446.70788763,
        447.07543172,  447.44293908,  447.81040971,  448.17784358,  448.54524069,
        448.91260102,  449.27992455,  449.64721127,  450.01446117,  450.38167423,
        450.74885043,  451.11598977,  451.48309222,  451.85015778,  452.21718643,
        452.58417816,  452.95113294,  453.31805077,  453.68493163,  454.05177551,
        454.4185824,  454.78535227,  455.15208511,  455.51878092,  455.88543967,
        456.25206136,  456.61864596,  456.98519346,  457.35170385,  457.71817712,
        458.08461324,  458.45101221,  458.81737401,  459.18369863,  459.54998605,
        459.91623625,  460.28244923,  460.64862497,  461.01476346,  461.38086467,
        461.7469286,  462.11295523,  462.47894455,  462.84489654,  463.21081119,
        463.57668848,  463.9425284,  464.30833094,  464.67409608,  465.0398238,
        465.4055141,  465.77116695,  466.13678235,  466.50236028,  466.86790072,
        467.23340366,  467.59886909,  467.96429699,  468.32968735,  468.69504015,
        469.06035538,  469.42563302,  469.79087306,  470.15607549,  470.52124029,
        470.88636744,  471.25145694,  471.61650876,  471.9815229,  472.34649934,
        472.71143806,  473.07633906,  473.44120231,  473.8060278,  474.17081551,
        474.53556544,  474.90027757,  475.26495189,  475.62958837,  475.99418701,
        476.35874779,  476.7232707,  477.08775571,  477.45220283,  477.81661203,
        478.1809833,  478.54531663,  478.90961199,  479.27386938,  479.63808879,
        480.00227019,  480.36641357,  480.73051892,  481.09458623,  481.45861547,
        481.82260665,  482.18655973,  482.55047471,  482.91435157,  483.2781903,
        483.64199089,  484.00575331,  484.36947756,  484.73316362,  485.09681147,
        485.46042111,  485.82399252,  486.18752567,  486.55102057,  486.91447719,
        487.27789552,  487.64127555,  488.00461726,  488.36792063,  488.73118566,
        489.09441233,  489.45760062,  489.82075051,  490.18386201,  490.54693508,
        490.90996972,  491.27296592,  491.63592365,  491.9988429,  492.36172367,
        492.72456592,  493.08736966,  493.45013486,  493.81286152,  494.17554961,
        494.53819913,  494.90081005,  495.26338237,  495.62591606,  495.98841112,
        496.35086754,  496.71328529,  497.07566436,  497.43800474,  497.80030641,
        498.16256936,  498.52479357,  498.88697904,  499.24912574,  499.61123367,
        499.9733028,  500.33533312,  500.69732462,  501.05927729,  501.4211911,
        501.78306605,  502.14490212,  502.5066993,  502.86845757,  503.23017692,
        503.59185733,  503.95349879,  504.31510129,  504.67666481,  505.03818933,
        505.39967484,  505.76112133,  506.12252879,  506.48389719,  506.84522653,
        507.20651678,  507.56776794,  507.92898,  508.29015293,  508.65128672,
        509.01238136,  509.37343683,  509.73445312,  510.09543022,  510.45636811,
        510.81726677,  511.1781262,  511.53894637,  511.89972728,  512.2604689,
        512.62117123,  512.98183425,  513.34245794,  513.7030423,  514.0635873,
        514.42409294,  514.78455919,  515.14498604,  515.50537349,  515.86572151,
        516.22603009,  516.58629922,  516.94652888,  517.30671906,  517.66686974,
        518.0269809,  518.38705255,  518.74708465,  519.1070772,  519.46703018,
        519.82694358,  520.18681738,  520.54665156,  520.90644612,  521.26620105,
        521.62591631,  521.98559191,  522.34522782,  522.70482404,  523.06438054,
        523.42389731,  523.78337435,  524.14281163,  524.50220914,  524.86156686,
        525.22088479,  525.5801629,  525.93940119,  526.29859963,  526.65775822,
        527.01687694,  527.37595577,  527.7349947,  528.09399372,  528.45295282,
        528.81187196,  529.17075116,  529.52959038,  529.88838962,  530.24714885,
        530.60586808,  530.96454727,  531.32318642,  531.68178552,  532.04034454,
        532.39886348,  532.75734231,  533.11578103,  533.47417963,  533.83253807,
        534.19085637,  534.54913448,  534.90737242,  535.26557015,  535.62372766,
        535.98184495,  536.33992199,  536.69795878,  537.05595529,  537.41391151,
        537.77182743,  538.12970304,  538.48753832,  538.84533325,  539.20308782,
        539.56080202,  539.91847583,  540.27610924,  540.63370224,  540.9912548,
        541.34876692,  541.70623857,  542.06366976,  542.42106045,  542.77841065,
        543.13572032,  543.49298947,  543.85021806,  544.2074061,  544.56455357,
        544.92166044,  545.27872671,  545.63575237,  545.99273739,  546.34968177,
        546.70658548,  547.06344852,  547.42027087,  547.77705252,  548.13379345,
        548.49049364,  548.84715309,  549.20377178,  549.56034969,  549.91688682,
        550.27338313,  550.62983863,  550.9862533,  551.34262712,  551.69896007,
        552.05525215,  552.41150334,  552.76771363,  553.12388299,  553.48001143,
        553.83609891,  554.19214543,  554.54815098,  554.90411553,  555.26003908,
        555.6159216,  555.9717631,  556.32756354,  556.68332292,  557.03904123,
        557.39471844,  557.75035455,  558.10594953,  558.46150339,  558.81701609,
        559.17248763,  559.52791799,  559.88330715,  560.23865512,  560.59396186,
        560.94922736,  561.30445162,  561.65963461,  562.01477632,  562.36987674,
        562.72493585,  563.07995364,  563.4349301,  563.7898652,  564.14475894,
        564.4996113,  564.85442227,  565.20919182,  565.56391996,  565.91860666,
        566.27325191,  566.62785569,  566.982418,  567.33693881,  567.69141811,
        568.04585589,  568.40025213,  568.75460682,  569.10891994,  569.46319149,
        569.81742144,  570.17160978,  570.52575649,  570.87986157,  571.233925,
        571.58794676,  571.94192684,  572.29586522,  572.6497619,  573.00361685,
        573.35743006,  573.71120152,  574.06493122,  574.41861913,  574.77226524,
        575.12586955,  575.47943203,  575.83295267,  576.18643146,  576.53986838,
        576.89326342,  577.24661656,  577.59992779,  577.9531971,  578.30642447,
        578.65960988,  579.01275333,  579.36585479,  579.71891426,  580.07193171,
        580.42490714,  580.77784053,  581.13073186,  581.48358113,  581.83638831,
        582.18915339,  582.54187637,  582.89455721,  583.24719592,  583.59979247,
        583.95234685,  584.30485905,  584.65732905,  585.00975684,  585.3621424,
        585.71448572,  586.06678678,  586.41904557,  586.77126208,  587.12343629,
        587.47556819,  587.82765776,  588.17970499,  588.53170986,  588.88367236,
        589.23559248,  589.5874702,  589.9393055,  590.29109838,  590.64284881,
        590.99455679,  591.34622229,  591.69784531,  592.04942583,  592.40096384,
        592.75245932,  593.10391225,  593.45532263,  593.80669044,  594.15801566,
        594.50929828,  594.86053828,  595.21173566,  595.56289039,  595.91400246,
        596.26507186,  596.61609858,  596.96708259,  597.31802389,  597.66892246,
        598.01977828,  598.37059135,  598.72136164,  599.07208915,  599.42277386,
        599.77341574,  600.1240148,  600.47457102,  600.82508437,  601.17555485,
        601.52598245,  601.87636714,  602.22670891,  602.57700776,  602.92726366,
        603.27747659,  603.62764656,  603.97777354,  604.32785751,  604.67789847,
        605.02789639,  605.37785127,  605.72776309,  606.07763184,  606.42745749,
        606.77724005,  607.12697948,  607.47667578,  607.82632894,  608.17593894,
        608.52550576,  608.87502939,  609.22450982,  609.57394703,  609.923341,
        610.27269173,  610.6219992,  610.97126339,  611.32048429,  611.66966189,
        612.01879617,  612.36788712,  612.71693472,  613.06593895,  613.41489981,
        613.76381728,  614.11269135,  614.46152199,  614.8103092,  615.15905296,
        615.50775326,  615.85641009,  616.20502342,  616.55359325,  616.90211955,
        617.25060233,  617.59904155,  617.94743721,  618.29578929,  618.64409779,
        618.99236267,  619.34058394,  619.68876157,  620.03689555,  620.38498586,
        620.7330325,  621.08103545,  621.42899469,  621.77691021,  622.12478199,
        622.47261002,  622.82039429,  623.16813478,  623.51583148,  623.86348437,
        624.21109344,  624.55865867,  624.90618005,  625.25365757,  625.6010912,
        625.94848095,  626.29582678,  626.6431287,  626.99038668,  627.3376007,
        627.68477076,  628.03189684,  628.37897893,  628.72601701,  629.07301106,
        629.41996108,  629.76686705,  630.11372895,  630.46054677,  630.8073205,
        631.15405011,  631.50073561,  631.84737696,  632.19397417,  632.5405272,
        632.88703606,  633.23350072,  633.57992117,  633.9262974,  634.27262938,
        634.61891712,  634.96516059,  635.31135978,  635.65751467,  636.00362525,
        636.3496915,  636.69571342,  637.04169099,  637.38762418,  637.733513,
        638.07935741,  638.42515742,  638.770913,  639.11662414,  639.46229083,
        639.80791305,  640.15349079,  640.49902403,  640.84451276,  641.18995696,
        641.53535663,  641.88071174,  642.22602228,  642.57128823,  642.91650959,
        643.26168634,  643.60681846,  643.95190594,  644.29694876,  644.64194692,
        644.98690039,  645.33180916,  645.67667323,  646.02149256,  646.36626715,
        646.71099699,  647.05568206,  647.40032234,  647.74491782,  648.08946849,
        648.43397434,  648.77843534,  649.12285148,  649.46722276,  649.81154915,
        650.15583064,  650.50006722,  650.84425887,  651.18840557,  651.53250732,
        651.8765641,  652.22057589,  652.56454269,  652.90846446,  653.25234121,
        653.59617292,  653.93995957,  654.28370115,  654.62739764,  654.97104903,
        655.31465531,  655.65821646,  656.00173246,  656.34520331,  656.68862898,
        657.03200947,  657.37534475,  657.71863482,  658.06187966,  658.40507926,
        658.7482336,  659.09134266,  659.43440644,  659.77742491,  660.12039807,
        660.4633259,  660.80620839,  661.14904551,  661.49183727,  661.83458363,
        662.17728459,  662.51994014,  662.86255025,  663.20511492,  663.54763413,
        663.89010787,  664.23253611,  664.57491886,  664.91725609,  665.25954778,
        665.60179393,  665.94399452,  666.28614954,  666.62825896,  666.97032278,
        667.31234099,  667.65431356,  667.99624049,  668.33812175,  668.67995734,
        669.02174724,  669.36349144,  669.70518992,  670.04684267,  670.38844966,
        670.7300109,  671.07152636,  671.41299603,  671.7544199,  672.09579795,
        672.43713016,  672.77841653,  673.11965704,  673.46085166,  673.8020004,
        674.14310323,  674.48416015,  674.82517113,  675.16613616,  675.50705523,
        675.84792832,  676.18875542,  676.52953652,  676.87027159,  677.21096063,
        677.55160362,  677.89220055,  678.2327514,  678.57325616,  678.91371481,
        679.25412735,  679.59449374,  679.93481399,  680.27508807,  680.61531598,
        680.95549769,  681.2956332,  681.63572249,  681.97576554,  682.31576234,
        682.65571287,  682.99561713,  683.33547509,  683.67528675,  684.01505208,
        684.35477108,  684.69444373,  685.03407001,  685.37364992,  685.71318343,
        686.05267053,  686.39211121,  686.73150546,  687.07085325,  687.41015457,
        687.74940942,  688.08861777,  688.42777962,  688.76689494,  689.10596372,
        689.44498596,  689.78396162,  690.12289071,  690.4617732,  690.80060908,
        691.13939834,  691.47814096,  691.81683693,  692.15548623,  692.49408885,
        692.83264478,  693.17115399,  693.50961648,  693.84803224,  694.18640124,
        694.52472347,  694.86299892,  695.20122758,  695.53940942,  695.87754444,
        696.21563263,  696.55367395,  696.89166842,  697.22961599,  697.56751668,
        697.90537045,  698.24317729,  698.5809372,  698.91865015,  699.25631613,
        699.59393514,  699.93150714,  700.26903213,  700.6065101,  700.94394103,
        701.2813249,  701.6186617,  701.95595142,  702.29319404,  702.63038955,
        702.96753794,  703.30463918,  703.64169327,  703.97870019,  704.31565992,
        704.65257246,  704.98943778,  705.32625588,  705.66302673,  705.99975033,
        706.33642666,  706.67305571,  707.00963745,  707.34617189,  707.68265899,
        708.01909876,  708.35549116,  708.6918362,  709.02813385,  709.36438411,
        709.70058694,  710.03674236,  710.37285032,  710.70891083,  711.04492387,
        711.38088943,  711.71680748,  712.05267802,  712.38850103,  712.7242765,
        713.06000441,  713.39568475,  713.73131751,  714.06690266,  714.40244019,
        714.7379301,  715.07337237,  715.40876697,  715.74411391,  716.07941316,
        716.4146647,  716.74986853,  717.08502463,  717.42013299,  717.75519359,
        718.09020641,  718.42517145,  718.76008869,  719.09495811,  719.4297797,
        719.76455344,  720.09927933,  720.43395734,  720.76858746,  721.10316968,
        721.43770399,  721.77219036,  722.10662879,  722.44101926,  722.77536176,
        723.10965626,  723.44390277,  723.77810125,  724.11225171,  724.44635412,
        724.78040847,  725.11441474,  725.44837292,  725.78228301,  726.11614497,
        726.4499588,  726.78372448,  727.11744201,  727.45111136,  727.78473252,
        728.11830547,  728.45183021,  728.78530671,  729.11873497,  729.45211496,
        729.78544668,  730.11873011,  730.45196524,  730.78515204,  731.11829052,
        731.45138064,  731.7844224,  732.11741579,  732.45036078,  732.78325737,
        733.11610555,  733.44890528,  733.78165657,  734.1143594,  734.44701375,
        734.7796196,  735.11217696,  735.44468579,  735.77714608,  736.10955783,
        736.44192102,  736.77423563,  737.10650164,  737.43871905,  737.77088784,
        738.10300799,  738.4350795,  738.76710234,  739.0990765,  739.43100197,
        739.76287873,  740.09470677,  740.42648608,  740.75821664,  741.08989843,
        741.42153144,  741.75311566,  742.08465107,  742.41613766,  742.74757542,
        743.07896432,  743.41030436,  743.74159552,  744.07283778,  744.40403114,
        744.73517558,  745.06627108,  745.39731762,  745.7283152,  746.05926381,
        746.39016341,  746.72101401,  747.05181559,  747.38256813,  747.71327162,
        748.04392604,  748.37453138,  748.70508762,  749.03559476,  749.36605277,
        749.69646165,  750.02682137,  750.35713192,  750.6873933,  751.01760548,
        751.34776845,  751.67788219,  752.0079467,  752.33796195,  752.66792794,
        752.99784465,  753.32771206,  753.65753015,  753.98729893,  754.31701836,
        754.64668845,  754.97630916,  755.30588049,  755.63540243,  755.96487495,
        756.29429805,  756.62367171,  756.95299591,  757.28227065,  757.6114959,
        757.94067166,  758.2697979,  758.59887462,  758.9279018,  759.25687943,
        759.58580748,  759.91468596,  760.24351483,  760.57229409,  760.90102373,
        761.22970372,  761.55833406,  761.88691473,  762.21544572,  762.54392701,
        762.87235858,  763.20074043,  763.52907254,  763.85735489,  764.18558747,
        764.51377027,  764.84190326,  765.16998645,  765.49801981,  765.82600332,
        766.15393698,  766.48182077,  766.80965467,  767.13743867,  767.46517276,
        767.79285692,  768.12049114,  768.4480754,  768.77560969,  769.103094,
        769.4305283,  769.75791259,  770.08524686,  770.41253107,  770.73976524,
        771.06694932,  771.39408333,  771.72116723,  772.04820102,  772.37518467,
        772.70211819,  773.02900155,  773.35583473,  773.68261773,  774.00935052,
        774.3360331,  774.66266545,  774.98924756,  775.3157794,  775.64226098,
        775.96869227,  776.29507325,  776.62140392,  776.94768426,  777.27391425,
        777.60009389,  777.92622315,  778.25230202,  778.57833049,  778.90430854,
        779.23023617,  779.55611334,  779.88194006,  780.2077163,  780.53344206,
        780.85911731,  781.18474205,  781.51031625,  781.83583991,  782.161313,
        782.48673552,  782.81210746,  783.13742879,  783.4626995,  783.78791958,
        784.11308901,  784.43820778,  784.76327588,  785.08829328,  785.41325998,
        785.73817597,  786.06304122,  786.38785572,  786.71261947,  787.03733243,
        787.36199461,  787.68660598,  788.01116653,  788.33567625,  788.66013512,
        788.98454313,  789.30890026,  789.63320651,  789.95746184,  790.28166626,
        790.60581974,  790.92992228,  791.25397385,  791.57797444,  791.90192405,
        792.22582265,  792.54967022,  792.87346677,  793.19721226,  793.52090669,
        793.84455004,  794.16814231,  794.49168346,  794.8151735,  795.13861239,
        795.46200014,  795.78533673,  796.10862214,  796.43185635,  796.75503936,
        797.07817115,  797.4012517,  797.724281,  798.04725903,  798.37018579,
        798.69306126,  799.01588541,  799.33865825,  799.66137975,  799.98404989,
        800.30666868,  800.62923608,  800.95175209,  801.27421669,  801.59662987,
        801.91899162,  802.24130191,  802.56356073,  802.88576808,  803.20792393,
        803.53002827,  803.85208109,  804.17408237,  804.4960321,  804.81793027,
        805.13977685,  805.46157184,  805.78331522,  806.10500698,  806.4266471,
        806.74823556,  807.06977236,  807.39125748,  807.7126909,  808.03407261,
        808.3554026,  808.67668085,  808.99790735,  809.31908208,  809.64020502,
        809.96127618,  810.28229552,  810.60326303,  810.92417871,  811.24504253,
        811.56585449,  811.88661456,  812.20732274,  812.52797901,  812.84858335,
        813.16913575,  813.4896362,  813.81008467,  814.13048117,  814.45082567,
        814.77111815,  815.09135861,  815.41154704,  815.7316834,  816.0517677,
        816.37179991,  816.69178003,  817.01170803,  817.33158391,  817.65140764,
        817.97117922,  818.29089863,  818.61056586,  818.93018089,  819.24974371,
        819.5692543,  819.88871264,  820.20811873,  820.52747256,  820.84677409,
        821.16602333,  821.48522025,  821.80436485,  822.12345711,  822.44249701,
        822.76148453,  823.08041968,  823.39930242,  823.71813275,  824.03691065,
        824.35563611,  824.67430911,  824.99292964,  825.31149768,  825.63001323,
        825.94847626,  826.26688676,  826.58524471,  826.90355011,  827.22180294,
        827.54000318,  827.85815083,  828.17624585,  828.49428825,  828.812278,
        829.1302151,  829.44809952,  829.76593125,  830.08371029,  830.40143661,
        830.71911019,  831.03673104,  831.35429912,  831.67181444,  831.98927696,
        832.30668668,  832.62404359,  832.94134767,  833.2585989,  833.57579727,
        833.89294277,  834.21003538,  834.52707509,  834.84406188,  835.16099574,
        835.47787665,  835.79470461,  836.11147959,  836.42820158,  836.74487057,
        837.06148654,  837.37804948,  837.69455938,  838.01101621,  838.32741997,
        838.64377064,  838.9600682,  839.27631265,  839.59250397,  839.90864213,
        840.22472714,  840.54075897,  840.85673762,  841.17266306,  841.48853528,
        841.80435426,  842.12012,  842.43583248,  842.75149168,  843.0670976,
        843.3826502,  843.69814949,  844.01359545,  844.32898805,  844.6443273,
        844.95961317,  845.27484564,  845.59002471,  845.90515037,  846.22022259,
        846.53524136,  846.85020666,  847.16511849,  847.47997683,  847.79478166,
        848.10953298,  848.42423075,  848.73887498,  849.05346565,  849.36800274,
        849.68248623,  849.99691612,  850.31129239,  850.62561502,  850.93988401,
        851.25409933,  851.56826097,  851.88236892,  852.19642316,  852.51042368,
        852.82437046,  853.1382635,  853.45210277,  853.76588826,  854.07961996,
        854.39329785,  854.70692192,  855.02049215,  855.33400853,  855.64747105,
        855.96087968,  856.27423443,  856.58753526,  856.90078217,  857.21397515,
        857.52711417,  857.84019923,  858.15323031,  858.4662074,  858.77913047,
        859.09199952,  859.40481454,  859.7175755,  860.0302824,  860.34293521,
        860.65553394,  860.96807855,  861.28056904,  861.59300539,  861.90538758,
        862.21771561,  862.52998946,  862.84220912,  863.15437456,  863.46648578,
        863.77854276,  864.09054549,  864.40249395,  864.71438813,  865.02622801,
        865.33801359,  865.64974484,  865.96142174,  866.2730443,  866.58461249,
        866.89612629,  867.2075857,  867.5189907,  867.83034127,  868.1416374,
        868.45287908,  868.76406628,  869.07519901,  869.38627724,  869.69730096,
        870.00827015,  870.3191848,  870.63004489,  870.94085042,  871.25160136,
        871.56229771,  871.87293944,  872.18352655,  872.49405902,  872.80453683,
        873.11495997,  873.42532842,  873.73564218,  874.04590123,  874.35610555,
        874.66625512,  874.97634994,  875.28639,  875.59637526,  875.90630573,
        876.21618138,  876.52600221,  876.83576819,  877.14547932,  877.45513558,
        877.76473695,  878.07428342,  878.38377498,  878.69321161,  879.00259329,
        879.31192002,  879.62119178,  879.93040855,  880.23957033,  880.54867708,
        880.85772881,  881.1667255,  881.47566713,  881.78455368,  882.09338515,
        882.40216152,  882.71088278,  883.0195489,  883.32815988,  883.6367157,
        883.94521635,  884.25366182,  884.56205208,  884.87038712,  885.17866694,
        885.48689151,  885.79506082,  886.10317486,  886.41123361,  886.71923706,
        887.0271852,  887.335078,  887.64291546,  887.95069756,  888.25842428,
        888.56609562,  888.87371155,  889.18127207,  889.48877716,  889.7962268,
        890.10362098,  890.41095969,  890.71824291,  891.02547062,  891.33264282,
        891.63975948,  891.9468206,  892.25382616,  892.56077615,  892.86767054,
        893.17450933,  893.48129251,  893.78802005,  894.09469194,  894.40130817,
        894.70786873,  895.0143736,  895.32082276,  895.62721621,  895.93355392,
        896.23983589,  896.54606209,  896.85223252,  897.15834715,  897.46440599,
        897.770409,  898.07635618,  898.38224751,  898.68808298,  898.99386257,
        899.29958627,  899.60525407,  899.91086595,  900.21642189,  900.52192188,
        900.82736591,  901.13275397,  901.43808603,  901.74336209,  902.04858212,
        902.35374612,  902.65885408,  902.96390597,  903.26890178,  903.5738415,
        903.87872511,  904.1835526,  904.48832396,  904.79303916,  905.09769821,
        905.40230107,  905.70684774,  906.01133821,  906.31577245,  906.62015046,
        906.92447222,  907.22873771,  907.53294692,  907.83709984,  908.14119646,
        908.44523675,  908.7492207,  909.05314831,  909.35701955,  909.6608344,
        909.96459287,  910.26829493,  910.57194056,  910.87552976,  911.1790625,
        911.48253879,  911.78595859,  912.08932189,  912.39262869,  912.69587896,
        912.9990727,  913.30220988,  913.6052905,  913.90831454,  914.21128198,
        914.51419281,  914.81704702,  915.11984459,  915.42258551,  915.72526976,
        916.02789734,  916.33046821,  916.63298238,  916.93543982,  917.23784052,
        917.54018447,  917.84247165,  918.14470205,  918.44687565,  918.74899244,
        919.05105241,  919.35305554,  919.65500182,  919.95689122,  920.25872375,
        920.56049937,  920.86221809,  921.16387988,  921.46548473,  921.76703263,
        922.06852356,  922.36995751,  922.67133445,  922.97265439,  923.2739173,
        923.57512317,  923.87627199,  924.17736373,  924.47839839,  924.77937596,
        925.08029641,  925.38115974,  925.68196592,  925.98271495,  926.28340681,
        926.58404149,  926.88461896,  927.18513923,  927.48560226,  927.78600806,
        928.0863566,  928.38664787,  928.68688185,  928.98705854,  929.28717791,
        929.58723995,  929.88724465,  930.187192,  930.48708197,  930.78691456,
        931.08668975,  931.38640753,  931.68606788,  931.98567078,  932.28521623,
        932.5847042,  932.88413469,  933.18350768,  933.48282316,  933.7820811,
        934.08128151,  934.38042435,  934.67950962,  934.97853731,  935.2775074,
        935.57641987,  935.87527471,  936.1740719,  936.47281144,  936.77149331,
        937.07011749,  937.36868397,  937.66719273,  937.96564376,  938.26403705,
        938.56237258,  938.86065033,  939.1588703,  939.45703247,  939.75513682,
        940.05318334,  940.35117201,  940.64910282,  940.94697576,  941.24479082,
        941.54254797,  941.8402472,  942.1378885,  942.43547186,  942.73299725,
        943.03046468,  943.32787411,  943.62522554,  943.92251895,  944.21975433,
        944.51693167,  944.81405094,  945.11111214,  945.40811525,  945.70506026,
        946.00194714,  946.2987759,  946.59554651,  946.89225895,  947.18891323,
        947.48550931,  947.78204719,  948.07852685,  948.37494827,  948.67131145,
        948.96761637,  949.26386301,  949.56005136,  949.85618141,  950.15225313,
        950.44826652,  950.74422157,  951.04011825,  951.33595656,  951.63173647,
        951.92745798,  952.22312107,  952.51872573,  952.81427194,  953.10975968,
        953.40518895,  953.70055972,  953.99587199,  954.29112574,  954.58632095,
        954.88145762,  955.17653572,  955.47155524,  955.76651618,  956.0614185,
        956.35626221,  956.65104727,  956.94577369,  957.24044145,  957.53505053,
        957.82960091,  958.12409259,  958.41852554,  958.71289976,  959.00721523,
        959.30147193,  959.59566986,  959.88980899,  960.18388932,  960.47791082,
        960.77187348,  961.0657773,  961.35962225,  961.65340832,  961.9471355,
        962.24080376,  962.53441311,  962.82796352,  963.12145497,  963.41488747,
        963.70826098,  964.00157549,  964.294831,  964.58802748,  964.88116493,
        965.17424333,  965.46726265,  965.7602229,  966.05312405,  966.3459661,
        966.63874902,  966.9314728,  967.22413743,  967.51674289,  967.80928917,
        968.10177625,  968.39420413,  968.68657278,  968.97888219,  969.27113235,
        969.56332324,  969.85545485,  970.14752716,  970.43954016,  970.73149384,
        971.02338818,  971.31522316,  971.60699878,  971.89871501,  972.19037185,
        972.48196927,  972.77350727,  973.06498583,  973.35640494,  973.64776458,
        973.93906473,  974.23030539,  974.52148653,  974.81260815,  975.10367023,
        975.39467275,  975.68561571,  975.97649908,  976.26732285,  976.55808701,
        976.84879154,  977.13943644,  977.43002167,  977.72054724,  978.01101312,
        978.30141931,  978.59176578,  978.88205252,  979.17227953,  979.46244677,
        979.75255425,  980.04260194,  980.33258983,  980.62251791,  980.91238616,
        981.20219457,  981.49194312,  981.7816318,  982.0712606,  982.3608295,
        982.65033848,  982.93978753,  983.22917664,  983.5185058,  983.80777498,
        984.09698417,  984.38613337,  984.67522255,  984.9642517,  985.25322081,
        985.54212986,  985.83097884,  986.11976773,  986.40849653,  986.6971652,
        986.98577375,  987.27432215,  987.5628104,  987.85123847,  988.13960635,
        988.42791404,  988.7161615,  989.00434874,  989.29247573,  989.58054247,
        989.86854893,  990.1564951,  990.44438097,  990.73220652,  991.01997175,
        991.30767663,  991.59532115,  991.88290529,  992.17042905,  992.4578924,
        992.74529534,  993.03263785,  993.31991991,  993.60714151,  993.89430263,
        994.18140327,  994.4684434,  994.75542302,  995.0423421,  995.32920064,
        995.61599862,  995.90273602,  996.18941284,  996.47602905,  996.76258464,
        997.0490796,  997.33551391,  997.62188756,  997.90820053,  998.19445282,
        998.4806444,  998.76677526,  999.05284539,  999.33885477,  999.62480339,
        999.91069124, 1000.19651829, 1000.48228454, 1000.76798997, 1001.05363456,
        1001.33921831, 1001.6247412, 1001.9102032, 1002.19560432, 1002.48094453,
        1002.76622382, 1003.05144218, 1003.33659959, 1003.62169604, 1003.90673151,
        1004.19170598, 1004.47661945, 1004.7614719, 1005.04626332, 1005.33099369,
        1005.61566299, 1005.90027122, 1006.18481835, 1006.46930437, 1006.75372928,
        1007.03809305, 1007.32239567, 1007.60663713, 1007.8908174, 1008.17493649,
        1008.45899437, 1008.74299102, 1009.02692644, 1009.31080061, 1009.59461352,
        1009.87836514, 1010.16205548, 1010.4456845, 1010.7292522, 1011.01275857,
        1011.29620359, 1011.57958724, 1011.86290951, 1012.14617038, 1012.42936985,
        1012.7125079, 1012.9955845, 1013.27859966, 1013.56155335, 1013.84444556,
        1014.12727628, 1014.41004548, 1014.69275317, 1014.97539931, 1015.25798391,
        1015.54050694, 1015.82296838, 1016.10536824, 1016.38770648, 1016.6699831,
        1016.95219808, 1017.2343514, 1017.51644306, 1017.79847304, 1018.08044133,
        1018.3623479, 1018.64419275, 1018.92597586, 1019.20769721, 1019.4893568,
        1019.77095461, 1020.05249062, 1020.33396482, 1020.6153772, 1020.89672773,
        1021.17801642, 1021.45924323, 1021.74040816, 1022.0215112, 1022.30255232,
        1022.58353152, 1022.86444877, 1023.14530408, 1023.42609741, 1023.70682876,
        1023.98749812, 1024.26810546, 1024.54865078
    ])

    def __init__(self):
        pass

    def get_nm_per_pixel(self):
        """Calculate width of each pixel in nanometers."""
        return np.hstack([
            (self.cal_wls[1] - self.cal_wls[0]),
            (self.cal_wls[2:] - self.cal_wls[:-2])/2,
            (self.cal_wls[-1] - self.cal_wls[-2])
        ])

    def process_measurements(self, spectra, info):
        """Process to visible wavelengths."""
        #breakpoint()
        spectra.columns = self.cal_wls
        
        # Counts per nanometer
        spectra = spectra.div(self.get_nm_per_pixel())
        
        # Counts per nanometer per second
        spectra = spectra.div((info.integration_time / (1000*1000)), axis=0)
        
        # Get rid of negative values
        spectra[spectra<0] = 0
        
        # TODO: Fix broken pixels
        
        # Resample to visible wavelengths
        f = interp1d(spectra.columns, spectra.to_numpy(), fill_value='extrapolate')
        visible_wavelengths = np.arange(380, 781, 1)
        visible_spds = f(visible_wavelengths)
        visible_spds = pd.DataFrame(visible_spds, columns=visible_wavelengths)
    
        return visible_spds



if __name__ == '__main__':
    jaz = EasyJAZ()
    spectra = pd.read_csv('/Users/jtm545/Projects/BakerWadeBBSRC/data/ProPixx/fo_gersun_halogenjaz_spectra.csv')
    info = pd.read_csv('/Users/jtm545/Projects/BakerWadeBBSRC/data/ProPixx/fo_gersun_halogenjaz_info.csv')

    processed = jaz.process_measurements(spectra, info)
    processed.index = ['FibreOptic', 'Gershun']
    processed.to_csv('/Users/jtm545/Projects/BakerWadeBBSRC/data/ProPixx/fo_gershun_halogen_jaz_processed.csv')
