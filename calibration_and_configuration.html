
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Calibration and configuration &#8212; PySilSub 0.0.13 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Calibration-and-configuration">
<h1>Calibration and configuration<a class="headerlink" href="#Calibration-and-configuration" title="Permalink to this heading">¶</a></h1>
<p>A standard RGB computer monitor has only three primaries. This means it isn’t great for silent substitution, but it is a good example to show how to calibrate and configure a multiprimary system for use with <em>PySilSub</em> because the same principles can be applied to a device with any number of primaries.</p>
<p>To make a calibration file you will need to measure the output of the primaries with a spectrometer. As a minimum, the file should include measurements for each primary at its maximum output, as well as an ambient spectral measurement where all primaries are off. Most standard monitors have 8-bit resolution which means that the input is specified with values between 0 and 255. So the settings to be measured are:</p>
<ul class="simple">
<li><p>Red: [255, 0, 0]</p></li>
<li><p>Green: [0, 255, 0]</p></li>
<li><p>Blue: [0, 0, 255]</p></li>
<li><p>Ambient measurement: [0, 0, 0]</p></li>
</ul>
<p>One way to obtain these measurements would be to write a simple program that sets the full screen colour using each of the above settings before sampling with a spectrometer.</p>
<p>When you have the measurements, put them in a CSV file where the first row describes the wavelength sampling (e.g., 380, 381, …, 780) and every subsequent row contains a spectral measurement. Also include column headers <em>Primary</em> and <em>Setting</em> with numerical values to identify the spectral measurements.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Primary</p></th>
<th class="head"><p>Setting</p></th>
<th class="head"><p>380</p></th>
<th class="head"><p>381</p></th>
<th class="head"><p>…</p></th>
<th class="head"><p>780</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>255</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>255</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>255</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
<p>With the above calibration file we are ready to go:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysilsub.device</span> <span class="kn">import</span> <span class="n">StimulationDevice</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">StimulationDevice</span><span class="p">(</span>
    <span class="n">resolutions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">],</span>
    <span class="n">calibration</span> <span class="o">=</span> <span class="s1">&#39;./calibration_file.csv&#39;</span><span class="p">,</span>
    <span class="n">wavelengths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">380</span><span class="p">,</span> <span class="mi">780</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Standard Monitor&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>We can now do useful things like plot the calibration SPDs and their chromaticities, as well as predict the spectral output of the device for any combination of settings.</p>
<p>This is OK, but most computer monitors–and most light devices for that matter–do not have a linear input-output relationship (sometimes called gamma), so our predictions are unlikely to be accurate. We can improve the accuracy of the device model by obtaining multiple measurements for each primary accross the input range. For example:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Primary</p></th>
<th class="head"><p>Setting</p></th>
<th class="head"><p>380</p></th>
<th class="head"><p>381</p></th>
<th class="head"><p>…</p></th>
<th class="head"><p>780</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>7</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>15</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>247</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>255</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>7</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>15</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>247</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>255</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>7</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>15</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>247</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>255</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
<p>For convenience, you can save your device settings in a JSON file and</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># Configure device</span>
<span class="n">RESOLUTIONS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">]</span>
<span class="n">COLORS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span>
<span class="n">CALIBRATION_FPATH</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;~/long/path/to/calibration_file.csv&quot;</span>
<span class="p">)</span>
<span class="n">CALIBRATION_UNITS</span> <span class="o">=</span> <span class="s2">&quot;W/m$^2$/nm&quot;</span>
<span class="n">NAME</span> <span class="o">=</span> <span class="s2">&quot;Standard Monitor (8-bit, RGB)&quot;</span>
<span class="n">JSON_NAME</span> <span class="o">=</span> <span class="s2">&quot;StandardMonitor&quot;</span>
<span class="n">WAVELENGTHS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">380</span><span class="p">,</span> <span class="mi">781</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Optional</span>
<span class="n">NOTES</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;A standard computer monitor calibration. Not very useful for silent substitution, but we may be able to do something interesting if we ignore rods and melanopsin.&quot;</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">device_config</span><span class="p">():</span>

    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;calibration_fpath&quot;</span><span class="p">:</span> <span class="n">CALIBRATION_FPATH</span><span class="p">,</span>
        <span class="s2">&quot;calibration_units&quot;</span><span class="p">:</span> <span class="n">CALIBRATION_UNITS</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">NAME</span><span class="p">,</span>
        <span class="s2">&quot;json_name&quot;</span><span class="p">:</span> <span class="n">JSON_NAME</span><span class="p">,</span>
        <span class="s2">&quot;wavelengths&quot;</span><span class="p">:</span> <span class="n">WAVELENGTHS</span><span class="p">,</span>
        <span class="s2">&quot;colors&quot;</span><span class="p">:</span> <span class="n">COLORS</span><span class="p">,</span>
        <span class="s2">&quot;resolutions&quot;</span><span class="p">:</span> <span class="n">RESOLUTIONS</span><span class="p">,</span>
        <span class="s2">&quot;notes&quot;</span><span class="p">:</span> <span class="n">NOTES</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../data/</span><span class="si">{</span><span class="n">JSON_NAME</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">device_config</span><span class="p">()</span>
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/photoreceptor_characters.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="index.html">PySilSub</a></h1>



<p class="blurb">A Python software for performing the method of silent substitution.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=PySilentSubstitution&repo=pysilsub&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="01_background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_project_notes.html">Project notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_funding.html">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_citation.html">Citation</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://pypi.org/project/pysilsub/">PyPi</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Joel T. Martin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/calibration_and_configuration.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>